<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FairShip: millepede/mpbits.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FairShip
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('mpbits_8f90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mpbits.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Bit field counters.  
<a href="#details">More...</a></p>

<p><a href="mpbits_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacempbits"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html">mpbits</a></td></tr>
<tr class="memdesc:namespacempbits"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit field data. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:afa57801baa6a34263fe5c2145a9ee5df"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpbits_8f90.html#afa57801baa6a34263fe5c2145a9ee5df">inbits</a> (im, jm, inc)</td></tr>
<tr class="memdesc:afa57801baa6a34263fe5c2145a9ee5df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill bit fields (counters).  <a href="mpbits_8f90.html#afa57801baa6a34263fe5c2145a9ee5df">More...</a><br /></td></tr>
<tr class="separator:afa57801baa6a34263fe5c2145a9ee5df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15637ecbbc501e760f3d4f7d687a8a6a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpbits_8f90.html#a15637ecbbc501e760f3d4f7d687a8a6a">clbits</a> (in, jreqpe, jhispe, jsngpe, jcmprs, jextnd, idimb, iencdb, ispc)</td></tr>
<tr class="memdesc:a15637ecbbc501e760f3d4f7d687a8a6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate bit (field) array size, encoding.  <a href="mpbits_8f90.html#a15637ecbbc501e760f3d4f7d687a8a6a">More...</a><br /></td></tr>
<tr class="separator:a15637ecbbc501e760f3d4f7d687a8a6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc3196af7a116ae0050f96c940c03ba3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpbits_8f90.html#afc3196af7a116ae0050f96c940c03ba3">ndbits</a> (ndims, ncmprs, nsparr, ihst)</td></tr>
<tr class="memdesc:afc3196af7a116ae0050f96c940c03ba3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Analyze bit fields.  <a href="mpbits_8f90.html#afc3196af7a116ae0050f96c940c03ba3">More...</a><br /></td></tr>
<tr class="separator:afc3196af7a116ae0050f96c940c03ba3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5565f05ff15ba9aba67b318aa2765c0c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpbits_8f90.html#a5565f05ff15ba9aba67b318aa2765c0c">ckbits</a> (ndims)</td></tr>
<tr class="memdesc:a5565f05ff15ba9aba67b318aa2765c0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check sparsity of matrix.  <a href="mpbits_8f90.html#a5565f05ff15ba9aba67b318aa2765c0c">More...</a><br /></td></tr>
<tr class="separator:a5565f05ff15ba9aba67b318aa2765c0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76f1a5c5e332b0acd9a036edf977c4fe"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpbits_8f90.html#a76f1a5c5e332b0acd9a036edf977c4fe">spbits</a> (nsparr, nsparc, ncmprs)</td></tr>
<tr class="memdesc:a76f1a5c5e332b0acd9a036edf977c4fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create sparsity information.  <a href="mpbits_8f90.html#a76f1a5c5e332b0acd9a036edf977c4fe">More...</a><br /></td></tr>
<tr class="separator:a76f1a5c5e332b0acd9a036edf977c4fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ee45ed456a58bf46d0b55ac62d04c0e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpbits_8f90.html#a8ee45ed456a58bf46d0b55ac62d04c0e">clbmap</a> (in)</td></tr>
<tr class="memdesc:a8ee45ed456a58bf46d0b55ac62d04c0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear (additional) bit map.  <a href="mpbits_8f90.html#a8ee45ed456a58bf46d0b55ac62d04c0e">More...</a><br /></td></tr>
<tr class="separator:a8ee45ed456a58bf46d0b55ac62d04c0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fcf35f8796ff738209a4634577f8769"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpbits_8f90.html#a9fcf35f8796ff738209a4634577f8769">inbmap</a> (im, jm)</td></tr>
<tr class="memdesc:a9fcf35f8796ff738209a4634577f8769"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill bit map.  <a href="mpbits_8f90.html#a9fcf35f8796ff738209a4634577f8769">More...</a><br /></td></tr>
<tr class="separator:a9fcf35f8796ff738209a4634577f8769"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30b4437f48cf9ea35a26f75b2e6c2a9a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpbits_8f90.html#a30b4437f48cf9ea35a26f75b2e6c2a9a">gpbmap</a> (npair)</td></tr>
<tr class="memdesc:a30b4437f48cf9ea35a26f75b2e6c2a9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get pairs (statistic) from map.  <a href="mpbits_8f90.html#a30b4437f48cf9ea35a26f75b2e6c2a9a">More...</a><br /></td></tr>
<tr class="separator:a30b4437f48cf9ea35a26f75b2e6c2a9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:adde3f0055bb8b56e1361d8a872674b1a"><td class="memItemLeft" align="right" valign="top">integer(mpl)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html#adde3f0055bb8b56e1361d8a872674b1a">mpbits::ndimb</a></td></tr>
<tr class="memdesc:adde3f0055bb8b56e1361d8a872674b1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">dimension for bit (field) array  <a href="namespacempbits.html#adde3f0055bb8b56e1361d8a872674b1a">More...</a><br /></td></tr>
<tr class="separator:adde3f0055bb8b56e1361d8a872674b1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b95f3e98f9dce0ac997663260947df0"><td class="memItemLeft" align="right" valign="top">integer(mpl)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html#a0b95f3e98f9dce0ac997663260947df0">mpbits::ndimb2</a></td></tr>
<tr class="memdesc:a0b95f3e98f9dce0ac997663260947df0"><td class="mdescLeft">&#160;</td><td class="mdescRight">dimension for bit map  <a href="namespacempbits.html#a0b95f3e98f9dce0ac997663260947df0">More...</a><br /></td></tr>
<tr class="separator:a0b95f3e98f9dce0ac997663260947df0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a456806b8abad6591c95cb43cf45991f5"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">mpbits::n</a></td></tr>
<tr class="memdesc:a456806b8abad6591c95cb43cf45991f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">matrix size (counters)  <a href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">More...</a><br /></td></tr>
<tr class="separator:a456806b8abad6591c95cb43cf45991f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00d494db0b1c256d51aa7dc03fb3414a"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html#a00d494db0b1c256d51aa7dc03fb3414a">mpbits::n2</a></td></tr>
<tr class="memdesc:a00d494db0b1c256d51aa7dc03fb3414a"><td class="mdescLeft">&#160;</td><td class="mdescRight">matrix size (map)  <a href="namespacempbits.html#a00d494db0b1c256d51aa7dc03fb3414a">More...</a><br /></td></tr>
<tr class="separator:a00d494db0b1c256d51aa7dc03fb3414a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ea64a113eb525506043be7c92133c96"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">mpbits::ibfw</a></td></tr>
<tr class="memdesc:a0ea64a113eb525506043be7c92133c96"><td class="mdescLeft">&#160;</td><td class="mdescRight">bit field width  <a href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">More...</a><br /></td></tr>
<tr class="separator:a0ea64a113eb525506043be7c92133c96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a092b420ebdc762fc51b649ca475a83f2"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html#a092b420ebdc762fc51b649ca475a83f2">mpbits::ireqpe</a></td></tr>
<tr class="memdesc:a092b420ebdc762fc51b649ca475a83f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">min number of pair entries  <a href="namespacempbits.html#a092b420ebdc762fc51b649ca475a83f2">More...</a><br /></td></tr>
<tr class="separator:a092b420ebdc762fc51b649ca475a83f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e33d38506425a8cdae517d26b465e97"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html#a7e33d38506425a8cdae517d26b465e97">mpbits::isngpe</a></td></tr>
<tr class="memdesc:a7e33d38506425a8cdae517d26b465e97"><td class="mdescLeft">&#160;</td><td class="mdescRight">upper bound for pair entry single precision storage  <a href="namespacempbits.html#a7e33d38506425a8cdae517d26b465e97">More...</a><br /></td></tr>
<tr class="separator:a7e33d38506425a8cdae517d26b465e97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5958876cd2674615d094fd9bfc0a9a6"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html#ab5958876cd2674615d094fd9bfc0a9a6">mpbits::icmprs</a></td></tr>
<tr class="memdesc:ab5958876cd2674615d094fd9bfc0a9a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">compression flag for sparsity (column indices)  <a href="namespacempbits.html#ab5958876cd2674615d094fd9bfc0a9a6">More...</a><br /></td></tr>
<tr class="separator:ab5958876cd2674615d094fd9bfc0a9a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13ad9e08781d0d7591b9f3278a596a30"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html#a13ad9e08781d0d7591b9f3278a596a30">mpbits::iextnd</a></td></tr>
<tr class="memdesc:a13ad9e08781d0d7591b9f3278a596a30"><td class="mdescLeft">&#160;</td><td class="mdescRight">flag for extended storage (both 'halves' of sym. mat. for improved access patterns)  <a href="namespacempbits.html#a13ad9e08781d0d7591b9f3278a596a30">More...</a><br /></td></tr>
<tr class="separator:a13ad9e08781d0d7591b9f3278a596a30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51404b84b43ea15b55a5da3a5e0d9181"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html#a51404b84b43ea15b55a5da3a5e0d9181">mpbits::nspc</a></td></tr>
<tr class="memdesc:a51404b84b43ea15b55a5da3a5e0d9181"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of precision for sparse global matrix (1=D, 2=D+f)  <a href="namespacempbits.html#a51404b84b43ea15b55a5da3a5e0d9181">More...</a><br /></td></tr>
<tr class="separator:a51404b84b43ea15b55a5da3a5e0d9181"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3ce01c37ac727a87b02ccd7d352aa97"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html#ab3ce01c37ac727a87b02ccd7d352aa97">mpbits::mxcnt</a></td></tr>
<tr class="memdesc:ab3ce01c37ac727a87b02ccd7d352aa97"><td class="mdescLeft">&#160;</td><td class="mdescRight">max value for bit field counters  <a href="namespacempbits.html#ab3ce01c37ac727a87b02ccd7d352aa97">More...</a><br /></td></tr>
<tr class="separator:ab3ce01c37ac727a87b02ccd7d352aa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af16fc58e032267904bb39d4c70fdb61c"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html#af16fc58e032267904bb39d4c70fdb61c">mpbits::nencdm</a></td></tr>
<tr class="memdesc:af16fc58e032267904bb39d4c70fdb61c"><td class="mdescLeft">&#160;</td><td class="mdescRight">max value for column counter  <a href="namespacempbits.html#af16fc58e032267904bb39d4c70fdb61c">More...</a><br /></td></tr>
<tr class="separator:af16fc58e032267904bb39d4c70fdb61c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a580ac1bdd4da9d8d58dc54c5c6b51de5"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html#a580ac1bdd4da9d8d58dc54c5c6b51de5">mpbits::nencdb</a></td></tr>
<tr class="memdesc:a580ac1bdd4da9d8d58dc54c5c6b51de5"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of bits for encoding column counter  <a href="namespacempbits.html#a580ac1bdd4da9d8d58dc54c5c6b51de5">More...</a><br /></td></tr>
<tr class="separator:a580ac1bdd4da9d8d58dc54c5c6b51de5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6629aea8d521ce7ee77d482c19ac192"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html#ac6629aea8d521ce7ee77d482c19ac192">mpbits::nthrd</a></td></tr>
<tr class="memdesc:ac6629aea8d521ce7ee77d482c19ac192"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of threads  <a href="namespacempbits.html#ac6629aea8d521ce7ee77d482c19ac192">More...</a><br /></td></tr>
<tr class="separator:ac6629aea8d521ce7ee77d482c19ac192"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea397564ea86fb7fe2b1c114b0871f4f"><td class="memItemLeft" align="right" valign="top">integer(mpi), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">mpbits::bitfieldcounters</a></td></tr>
<tr class="memdesc:aea397564ea86fb7fe2b1c114b0871f4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">fit field counters for global parameters pairs (tracks)  <a href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">More...</a><br /></td></tr>
<tr class="separator:aea397564ea86fb7fe2b1c114b0871f4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae2845e345a87b36b52288605541a96d"><td class="memItemLeft" align="right" valign="top">integer(mpi), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html#aae2845e345a87b36b52288605541a96d">mpbits::bitmap</a></td></tr>
<tr class="memdesc:aae2845e345a87b36b52288605541a96d"><td class="mdescLeft">&#160;</td><td class="mdescRight">fit field map for global parameters pairs (measurements)  <a href="namespacempbits.html#aae2845e345a87b36b52288605541a96d">More...</a><br /></td></tr>
<tr class="separator:aae2845e345a87b36b52288605541a96d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b6174ff4f7f83f062c5e161555035db"><td class="memItemLeft" align="right" valign="top">integer(mpi), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">mpbits::bs</a> = BIT_SIZE(1_mpi)</td></tr>
<tr class="memdesc:a4b6174ff4f7f83f062c5e161555035db"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of bits in INTEGER(mpi)  <a href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">More...</a><br /></td></tr>
<tr class="separator:a4b6174ff4f7f83f062c5e161555035db"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Bit field counters. </p>
<dl class="section author"><dt>Author</dt><dd>Volker Blobel, University Hamburg, 2005-2009 (initial Fortran77 version) </dd>
<dd>
Claus Kleinwort, DESY (maintenance and developement)</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2009 - 2015 Deutsches Elektronen-Synchroton, Member of the Helmholtz Association, (DESY), HAMBURG, GERMANY <br  />
<br  />
 This library is free software; you can redistribute it and/or modify it under the terms of the GNU Library General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version. <br  />
<br  />
 This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Library General Public License for more details. <br  />
<br  />
 You should have received a copy of the GNU Library General Public License along with this program (see the file COPYING.LIB for more details); if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</dd></dl>
<p>Count pairs of global parameters for sparse storage of global matrix, apply pair entries cut and build (compressed) sparsity structure (row offsets, column lists).</p>
<p>In sparse storage mode for each row the list of column indices with non zero elements (and those elements) are stored. With compression this list is represented by the first column and their number for continous regions (encoded in single INTEGER(mpi) words). Rare elements may be stored in single precision.</p>
<p>An additional bit map is used to monitor the parameter pairs for measurements (or 'equations'). </p>

<p class="definition">Definition in file <a class="el" href="mpbits_8f90_source.html">mpbits.f90</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a5565f05ff15ba9aba67b318aa2765c0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5565f05ff15ba9aba67b318aa2765c0c">&#9670;&nbsp;</a></span>ckbits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ckbits </td>
          <td>(</td>
          <td class="paramtype">integer(mpl), dimension(4), intent(out)&#160;</td>
          <td class="paramname"><em>ndims</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check sparsity of matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ndims</td><td>(1): (reduced) size of bit array; (2): size of column lists; (3/4): number of (double/single precision) off diagonal elements; </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpbits_8f90_source.html#l00486">486</a> of file <a class="el" href="mpbits_8f90_source.html">mpbits.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempbits.html">mpbits</a></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span>, <span class="keywordtype">DIMENSION(4)</span>, <span class="keywordtype">INTENT(OUT)</span> :: ndims</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: nwcp(0:1)</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: irgn(2)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: inr(2)</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: ll</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: noffi</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: last</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: lrgn</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: next</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: icp</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ib</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: icount</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: kbfw</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: jp</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: mm</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordtype">LOGICAL</span> :: btest</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">DO</span> i=1,4</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        ndims(i)=0</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    kbfw=1</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">IF</span> (<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a> &gt; 1.AND.<a class="code" href="namespacempbits.html#ab5958876cd2674615d094fd9bfc0a9a6">icmprs</a> &gt; 0) kbfw=2</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    ll=0</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">DO</span> i=1,<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        noffi=int(i-1,mpl)*int(i-2,mpl)*int(<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a>,mpl)/2</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        ll=noffi/<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>+i</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        mm=0</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        inr(1)=0</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        inr(2)=0</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        irgn(1)=0</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        irgn(2)=0</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        last=0</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        lrgn=0</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keywordflow">DO</span> j=1,i-1</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            icount=0</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            next=0</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="keywordflow">DO</span> ib=0,<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a>-1</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                <span class="keywordflow">IF</span> (btest(<a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>(ll),mm)) icount=ibset(icount,ib)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                mm=mm+1</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                <span class="keywordflow">IF</span> (mm &gt;= <a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                    ll=ll+1</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    mm=mm-<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <span class="keywordflow">IF</span> (icount &gt; 0) ndims(1)=ndims(1)+1</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <span class="comment">!           keep pair ?</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <span class="keywordflow">IF</span> (icount &gt;= <a class="code" href="namespacempbits.html#a092b420ebdc762fc51b649ca475a83f2">ireqpe</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                next=1 <span class="comment">! double</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                <span class="keywordflow">IF</span> (icount &lt;= <a class="code" href="namespacempbits.html#a7e33d38506425a8cdae517d26b465e97">isngpe</a>) next=2 <span class="comment">! single</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                inr(next)=inr(next)+1</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                <span class="keywordflow">IF</span> (next /= last.OR.lrgn &gt;= <a class="code" href="namespacempbits.html#af16fc58e032267904bb39d4c70fdb61c">nencdm</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                    irgn(next)=irgn(next)+1</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                    lrgn=0</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                lrgn=lrgn+1</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            last=next</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">IF</span> (<a class="code" href="namespacempbits.html#ab5958876cd2674615d094fd9bfc0a9a6">icmprs</a> &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="keywordflow">DO</span> jp=1,kbfw</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                <span class="keywordflow">IF</span> (inr(jp) &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                    icp=0</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                    nwcp(0)=inr(jp)                    <span class="comment">! list of column indices (default)</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                    nwcp(1)=irgn(jp)+(irgn(jp)+7)/8    <span class="comment">! list of regions of consecutive columns</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                    <span class="comment">!                 compress row ?</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                    <span class="keywordflow">IF</span> (nwcp(1) &lt; nwcp(0).OR. <a class="code" href="namespacempbits.html#a13ad9e08781d0d7591b9f3278a596a30">iextnd</a> &gt; 0) icp=1</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                    ndims(2)   =ndims(2)   +nwcp(icp)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                    ndims(jp+2)=ndims(jp+2)+nwcp(0)</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            ndims(2)=ndims(2)+inr(1)</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            ndims(3)=ndims(3)+inr(1)</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="ttc" id="anamespacempbits_html"><div class="ttname"><a href="namespacempbits.html">mpbits</a></div><div class="ttdoc">Bit field data.</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00035">mpbits.f90:35</a></div></div>
<div class="ttc" id="anamespacempbits_html_a092b420ebdc762fc51b649ca475a83f2"><div class="ttname"><a href="namespacempbits.html#a092b420ebdc762fc51b649ca475a83f2">mpbits::ireqpe</a></div><div class="ttdeci">integer(mpi) ireqpe</div><div class="ttdoc">min number of pair entries</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00044">mpbits.f90:44</a></div></div>
<div class="ttc" id="anamespacempbits_html_a0ea64a113eb525506043be7c92133c96"><div class="ttname"><a href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">mpbits::ibfw</a></div><div class="ttdeci">integer(mpi) ibfw</div><div class="ttdoc">bit field width</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00043">mpbits.f90:43</a></div></div>
<div class="ttc" id="anamespacempbits_html_a13ad9e08781d0d7591b9f3278a596a30"><div class="ttname"><a href="namespacempbits.html#a13ad9e08781d0d7591b9f3278a596a30">mpbits::iextnd</a></div><div class="ttdeci">integer(mpi) iextnd</div><div class="ttdoc">flag for extended storage (both 'halves' of sym. mat. for improved access patterns)</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00047">mpbits.f90:47</a></div></div>
<div class="ttc" id="anamespacempbits_html_a456806b8abad6591c95cb43cf45991f5"><div class="ttname"><a href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">mpbits::n</a></div><div class="ttdeci">integer(mpi) n</div><div class="ttdoc">matrix size (counters)</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00041">mpbits.f90:41</a></div></div>
<div class="ttc" id="anamespacempbits_html_a4b6174ff4f7f83f062c5e161555035db"><div class="ttname"><a href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">mpbits::bs</a></div><div class="ttdeci">integer(mpi), parameter bs</div><div class="ttdoc">number of bits in INTEGER(mpi)</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00055">mpbits.f90:55</a></div></div>
<div class="ttc" id="anamespacempbits_html_a7e33d38506425a8cdae517d26b465e97"><div class="ttname"><a href="namespacempbits.html#a7e33d38506425a8cdae517d26b465e97">mpbits::isngpe</a></div><div class="ttdeci">integer(mpi) isngpe</div><div class="ttdoc">upper bound for pair entry single precision storage</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00045">mpbits.f90:45</a></div></div>
<div class="ttc" id="anamespacempbits_html_ab5958876cd2674615d094fd9bfc0a9a6"><div class="ttname"><a href="namespacempbits.html#ab5958876cd2674615d094fd9bfc0a9a6">mpbits::icmprs</a></div><div class="ttdeci">integer(mpi) icmprs</div><div class="ttdoc">compression flag for sparsity (column indices)</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00046">mpbits.f90:46</a></div></div>
<div class="ttc" id="anamespacempbits_html_aea397564ea86fb7fe2b1c114b0871f4f"><div class="ttname"><a href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">mpbits::bitfieldcounters</a></div><div class="ttdeci">integer(mpi), dimension(:), allocatable bitfieldcounters</div><div class="ttdoc">fit field counters for global parameters pairs (tracks)</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00053">mpbits.f90:53</a></div></div>
<div class="ttc" id="anamespacempbits_html_af16fc58e032267904bb39d4c70fdb61c"><div class="ttname"><a href="namespacempbits.html#af16fc58e032267904bb39d4c70fdb61c">mpbits::nencdm</a></div><div class="ttdeci">integer(mpi) nencdm</div><div class="ttdoc">max value for column counter</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00050">mpbits.f90:50</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a15637ecbbc501e760f3d4f7d687a8a6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15637ecbbc501e760f3d4f7d687a8a6a">&#9670;&nbsp;</a></span>clbits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine clbits </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>jreqpe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>jhispe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>jsngpe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>jcmprs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>jextnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpl), intent(out)&#160;</td>
          <td class="paramname"><em>idimb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>iencdb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>ispc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate bit (field) array size, encoding. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>matrix size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jreqpe</td><td>min number of pair entries </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jhispe</td><td>mupper bound for pair entry histogrammimg </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jsngpe</td><td>upper bound for pair entry single precision storage </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jcmprs</td><td>compression flag for sparsity (column indices) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jextnd</td><td>flag for extended storage </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">idimb</td><td>dimension for bit (field) array </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">iencdb</td><td>number of bits for encoding column counter </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ispc</td><td>number of precision for sparse global matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpbits_8f90_source.html#l00147">147</a> of file <a class="el" href="mpbits_8f90_source.html">mpbits.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempbits.html">mpbits</a></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempdalc.html">mpdalc</a></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: in</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: jreqpe</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: jhispe</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: jsngpe</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: jcmprs</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: jextnd</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span>, <span class="keywordtype">INTENT(OUT)</span> :: idimb</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span> :: iencdb</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span> :: ispc</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: noffd</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: icount</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: mb</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: nbcol</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">!$    INTEGER(mpi) :: OMP_GET_MAX_THREADS</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">! save input parameter </span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>=in</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="namespacempbits.html#a092b420ebdc762fc51b649ca475a83f2">ireqpe</a>=jreqpe</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="namespacempbits.html#a7e33d38506425a8cdae517d26b465e97">isngpe</a>=jsngpe</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="namespacempbits.html#ab5958876cd2674615d094fd9bfc0a9a6">icmprs</a>=jcmprs+jextnd <span class="comment">! enforce compression for extended storage</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="namespacempbits.html#a13ad9e08781d0d7591b9f3278a596a30">iextnd</a>=jextnd</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">! number of precision types (D, F)</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    ispc=1</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> (jsngpe&gt;0) ispc=2</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="namespacempbits.html#a51404b84b43ea15b55a5da3a5e0d9181">nspc</a> = ispc</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">! bit field size</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    icount=max(jsngpe+1,jhispe)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    icount=max(jreqpe,icount)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a>=1 <span class="comment">! number of bits needed to count up to ICOUNT</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="namespacempbits.html#ab3ce01c37ac727a87b02ccd7d352aa97">mxcnt</a>=1</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">DO</span> i=1,30</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">IF</span> (icount &gt; <a class="code" href="namespacempbits.html#ab3ce01c37ac727a87b02ccd7d352aa97">mxcnt</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a>=<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a>+1</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <a class="code" href="namespacempbits.html#ab3ce01c37ac727a87b02ccd7d352aa97">mxcnt</a>=<a class="code" href="namespacempbits.html#ab3ce01c37ac727a87b02ccd7d352aa97">mxcnt</a>*2+1</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">! bit field array size</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    noffd=int(<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>,mpl)*int(<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>-1,mpl)*int(<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a>,mpl)/2</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="namespacempbits.html#adde3f0055bb8b56e1361d8a872674b1a">ndimb</a>=noffd/<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>+<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    idimb=<a class="code" href="namespacempbits.html#adde3f0055bb8b56e1361d8a872674b1a">ndimb</a></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    mb=int(4.0e-6*real(<a class="code" href="namespacempbits.html#adde3f0055bb8b56e1361d8a872674b1a">ndimb</a>,mps),mpi)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;CLBITS: symmetric matrix of dimension&#39;</span>,<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;CLBITS: off-diagonal elements&#39;</span>,noffd</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">IF</span> (mb &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;CLBITS: dimension of bit-array&#39;</span>,<a class="code" href="namespacempbits.html#adde3f0055bb8b56e1361d8a872674b1a">ndimb</a> , <span class="stringliteral">&#39;(&#39;</span>,mb,<span class="stringliteral">&#39;MB)&#39;</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;CLBITS: dimension of bit-array&#39;</span>,<a class="code" href="namespacempbits.html#adde3f0055bb8b56e1361d8a872674b1a">ndimb</a> , <span class="stringliteral">&#39;(&lt; 1 MB)&#39;</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keyword">CALL </span><a class="code" href="interfacempdalc_1_1mpalloc.html">mpalloc</a>(<a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>,<a class="code" href="namespacempbits.html#adde3f0055bb8b56e1361d8a872674b1a">ndimb</a>,<span class="stringliteral">&#39;INBITS: bit storage&#39;</span>)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>=0</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">!     encoding for compression</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    nbcol=<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>/2    <span class="comment">! one half of the bits for column number, other for column counter</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">DO</span> i=<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>/2,<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>-2</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">IF</span> (btest(<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>,i)) nbcol=i+1 <span class="comment">! more bits for column number</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="namespacempbits.html#a580ac1bdd4da9d8d58dc54c5c6b51de5">nencdb</a>=<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>-nbcol</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    iencdb=<a class="code" href="namespacempbits.html#a580ac1bdd4da9d8d58dc54c5c6b51de5">nencdb</a></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="namespacempbits.html#af16fc58e032267904bb39d4c70fdb61c">nencdm</a>=ishft(1,<a class="code" href="namespacempbits.html#a580ac1bdd4da9d8d58dc54c5c6b51de5">nencdb</a>)-1</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="namespacempbits.html#ac6629aea8d521ce7ee77d482c19ac192">nthrd</a>=1</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">!$ NTHRD=OMP_GET_MAX_THREADS()</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="ttc" id="ainterfacempdalc_1_1mpalloc_html"><div class="ttname"><a href="interfacempdalc_1_1mpalloc.html">mpdalc::mpalloc</a></div><div class="ttdoc">allocate array</div><div class="ttdef"><b>Definition:</b> <a href="mpdalc_8f90_source.html#l00036">mpdalc.f90:36</a></div></div>
<div class="ttc" id="anamespacempbits_html_a51404b84b43ea15b55a5da3a5e0d9181"><div class="ttname"><a href="namespacempbits.html#a51404b84b43ea15b55a5da3a5e0d9181">mpbits::nspc</a></div><div class="ttdeci">integer(mpi) nspc</div><div class="ttdoc">number of precision for sparse global matrix (1=D, 2=D+f)</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00048">mpbits.f90:48</a></div></div>
<div class="ttc" id="anamespacempbits_html_a580ac1bdd4da9d8d58dc54c5c6b51de5"><div class="ttname"><a href="namespacempbits.html#a580ac1bdd4da9d8d58dc54c5c6b51de5">mpbits::nencdb</a></div><div class="ttdeci">integer(mpi) nencdb</div><div class="ttdoc">number of bits for encoding column counter</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00051">mpbits.f90:51</a></div></div>
<div class="ttc" id="anamespacempbits_html_ab3ce01c37ac727a87b02ccd7d352aa97"><div class="ttname"><a href="namespacempbits.html#ab3ce01c37ac727a87b02ccd7d352aa97">mpbits::mxcnt</a></div><div class="ttdeci">integer(mpi) mxcnt</div><div class="ttdoc">max value for bit field counters</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00049">mpbits.f90:49</a></div></div>
<div class="ttc" id="anamespacempbits_html_ac6629aea8d521ce7ee77d482c19ac192"><div class="ttname"><a href="namespacempbits.html#ac6629aea8d521ce7ee77d482c19ac192">mpbits::nthrd</a></div><div class="ttdeci">integer(mpi) nthrd</div><div class="ttdoc">number of threads</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00052">mpbits.f90:52</a></div></div>
<div class="ttc" id="anamespacempbits_html_adde3f0055bb8b56e1361d8a872674b1a"><div class="ttname"><a href="namespacempbits.html#adde3f0055bb8b56e1361d8a872674b1a">mpbits::ndimb</a></div><div class="ttdeci">integer(mpl) ndimb</div><div class="ttdoc">dimension for bit (field) array</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00039">mpbits.f90:39</a></div></div>
<div class="ttc" id="anamespacempdalc_html"><div class="ttname"><a href="namespacempdalc.html">mpdalc</a></div><div class="ttdoc">(De)Allocate vectors and arrays.</div><div class="ttdef"><b>Definition:</b> <a href="mpdalc_8f90_source.html#l00024">mpdalc.f90:24</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ee45ed456a58bf46d0b55ac62d04c0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ee45ed456a58bf46d0b55ac62d04c0e">&#9670;&nbsp;</a></span>clbmap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine clbmap </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear (additional) bit map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>matrix size </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpbits_8f90_source.html#l00729">729</a> of file <a class="el" href="mpbits_8f90_source.html">mpbits.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempbits.html">mpbits</a></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempdalc.html">mpdalc</a></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: in</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: noffd</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: mb</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="comment">! save input parameter </span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <a class="code" href="namespacempbits.html#a00d494db0b1c256d51aa7dc03fb3414a">n2</a>=in    </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="comment">! bit field array size</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    noffd=int(<a class="code" href="namespacempbits.html#a00d494db0b1c256d51aa7dc03fb3414a">n2</a>,mpl)*int(<a class="code" href="namespacempbits.html#a00d494db0b1c256d51aa7dc03fb3414a">n2</a>-1,mpl)/2</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <a class="code" href="namespacempbits.html#a0b95f3e98f9dce0ac997663260947df0">ndimb2</a>=noffd/<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>+<a class="code" href="namespacempbits.html#a00d494db0b1c256d51aa7dc03fb3414a">n2</a></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    mb=int(4.0e-6*real(<a class="code" href="namespacempbits.html#a0b95f3e98f9dce0ac997663260947df0">ndimb2</a>,mps),mpi)</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordflow">IF</span> (mb &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;CLBMAP: dimension of bit-map&#39;</span>,<a class="code" href="namespacempbits.html#a0b95f3e98f9dce0ac997663260947df0">ndimb2</a> , <span class="stringliteral">&#39;(&#39;</span>,mb,<span class="stringliteral">&#39;MB)&#39;</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;CLBMAP: dimension of bit-map&#39;</span>,<a class="code" href="namespacempbits.html#a0b95f3e98f9dce0ac997663260947df0">ndimb2</a> , <span class="stringliteral">&#39;(&lt; 1 MB)&#39;</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keyword">CALL </span><a class="code" href="interfacempdalc_1_1mpalloc.html">mpalloc</a>(<a class="code" href="namespacempbits.html#aae2845e345a87b36b52288605541a96d">bitmap</a>,<a class="code" href="namespacempbits.html#a0b95f3e98f9dce0ac997663260947df0">ndimb2</a>,<span class="stringliteral">&#39;INBMAP: bit storage&#39;</span>)</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <a class="code" href="namespacempbits.html#aae2845e345a87b36b52288605541a96d">bitmap</a>=0</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="ttc" id="anamespacempbits_html_a00d494db0b1c256d51aa7dc03fb3414a"><div class="ttname"><a href="namespacempbits.html#a00d494db0b1c256d51aa7dc03fb3414a">mpbits::n2</a></div><div class="ttdeci">integer(mpi) n2</div><div class="ttdoc">matrix size (map)</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00042">mpbits.f90:42</a></div></div>
<div class="ttc" id="anamespacempbits_html_a0b95f3e98f9dce0ac997663260947df0"><div class="ttname"><a href="namespacempbits.html#a0b95f3e98f9dce0ac997663260947df0">mpbits::ndimb2</a></div><div class="ttdeci">integer(mpl) ndimb2</div><div class="ttdoc">dimension for bit map</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00040">mpbits.f90:40</a></div></div>
<div class="ttc" id="anamespacempbits_html_aae2845e345a87b36b52288605541a96d"><div class="ttname"><a href="namespacempbits.html#aae2845e345a87b36b52288605541a96d">mpbits::bitmap</a></div><div class="ttdeci">integer(mpi), dimension(:), allocatable bitmap</div><div class="ttdoc">fit field map for global parameters pairs (measurements)</div><div class="ttdef"><b>Definition:</b> <a href="mpbits_8f90_source.html#l00054">mpbits.f90:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a30b4437f48cf9ea35a26f75b2e6c2a9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30b4437f48cf9ea35a26f75b2e6c2a9a">&#9670;&nbsp;</a></span>gpbmap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gpbmap </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>npair</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get pairs (statistic) from map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">npair</td><td>number of paired parameters </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpbits_8f90_source.html#l00791">791</a> of file <a class="el" href="mpbits_8f90_source.html">mpbits.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempbits.html">mpbits</a></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(OUT)</span> :: npair</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: l</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: noffi</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: m</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordtype">LOGICAL</span> :: btest</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    npair(1:<a class="code" href="namespacempbits.html#a00d494db0b1c256d51aa7dc03fb3414a">n2</a>)=0</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    l=0</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">DO</span> i=1,<a class="code" href="namespacempbits.html#a00d494db0b1c256d51aa7dc03fb3414a">n2</a></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        noffi=int(i-1,mpl)*int(i-2,mpl)/2</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        l=noffi/<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>+i</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        m=0</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <span class="keywordflow">DO</span> j=1,i-1</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            <span class="keywordflow">IF</span> (btest(<a class="code" href="namespacempbits.html#aae2845e345a87b36b52288605541a96d">bitmap</a>(l),m)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                npair(i)=npair(i)+1</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                npair(j)=npair(j)+1</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            m=m+1</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            <span class="keywordflow">IF</span> (m &gt;= <a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                l=l+1</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                m=m-<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordflow">RETURN</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="afa57801baa6a34263fe5c2145a9ee5df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa57801baa6a34263fe5c2145a9ee5df">&#9670;&nbsp;</a></span>inbits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine inbits </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>jm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>inc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill bit fields (counters). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">im</td><td>first index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jm</td><td>second index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inc</td><td>increment (usually 1) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpbits_8f90_source.html#l00065">65</a> of file <a class="el" href="mpbits_8f90_source.html">mpbits.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempbits.html">mpbits</a></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: im</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: jm</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: inc</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: l</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: ll</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: noffj</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: m</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: mm</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: icount</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ib</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: jcount</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: noffi</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordtype">LOGICAL</span> :: btest</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">IF</span>(im == jm) <span class="keywordflow">RETURN</span>  <span class="comment">! diagonal</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    j=min(im,jm)</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    i=max(im,jm)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">IF</span>(j &lt;= 0) <span class="keywordflow">RETURN</span>    <span class="comment">! out low</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">IF</span>(i &gt; <a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>) <span class="keywordflow">RETURN</span>    <span class="comment">! out high</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    noffi=int(i-1,mpl)*int(i-2,mpl)*int(<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a>,mpl)/2 <span class="comment">! for J=1</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    noffj=(j-1)*<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    l=noffi/<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>+i+noffj/<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a> <span class="comment">! row offset + column offset</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">!     add I instead of 1 to keep bit maps of different rows in different words (openMP !)</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    m=mod(noffj,<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">IF</span> (<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a> &lt;= 1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>(l)=ibset(<a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>(l),m)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="comment">!        get counter from bit field</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        ll=l</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        mm=m</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        icount=0</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">DO</span> ib=0,<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a>-1</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordflow">IF</span> (btest(<a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>(ll),mm)) icount=ibset(icount,ib)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            mm=mm+1</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="keywordflow">IF</span> (mm &gt;= <a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                ll=ll+1</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                mm=mm-<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="comment">!        increment</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        jcount=icount</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        icount=min(icount+inc,<a class="code" href="namespacempbits.html#ab3ce01c37ac727a87b02ccd7d352aa97">mxcnt</a>)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="comment">!        store counter into bit field</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">IF</span> (icount /= jcount) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            ll=l</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            mm=m</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordflow">DO</span> ib=0,<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a>-1</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <span class="keywordflow">IF</span> (btest(icount,ib)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                    <a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>(ll)=ibset(<a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>(ll),mm)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    <a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>(ll)=ibclr(<a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>(ll),mm)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                mm=mm+1</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                <span class="keywordflow">IF</span> (mm &gt;= <a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                    ll=ll+1</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                    mm=mm-<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9fcf35f8796ff738209a4634577f8769"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fcf35f8796ff738209a4634577f8769">&#9670;&nbsp;</a></span>inbmap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine inbmap </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>jm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill bit map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">im</td><td>first index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jm</td><td>second index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpbits_8f90_source.html#l00760">760</a> of file <a class="el" href="mpbits_8f90_source.html">mpbits.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempbits.html">mpbits</a></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: im</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: jm</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: l</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: noffj</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: noffi</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: m</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">IF</span>(im == jm) <span class="keywordflow">RETURN</span>  <span class="comment">! diagonal</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    j=min(im,jm)</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    i=max(im,jm)</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keywordflow">IF</span>(j &lt;= 0) <span class="keywordflow">RETURN</span>    <span class="comment">! out low</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">IF</span>(i &gt; <a class="code" href="namespacempbits.html#a00d494db0b1c256d51aa7dc03fb3414a">n2</a>) <span class="keywordflow">RETURN</span>    <span class="comment">! out high</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    noffi=int(i-1,mpl)*int(i-2,mpl)/2 <span class="comment">! for J=1</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    noffj=(j-1)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    l=noffi/<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>+i+noffj/<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a> <span class="comment">! row offset + column offset</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="comment">!     add I instead of 1 to keep bit maps of different rows in different words (openMP !)</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    m=mod(noffj,<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>)</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <a class="code" href="namespacempbits.html#aae2845e345a87b36b52288605541a96d">bitmap</a>(l)=ibset(<a class="code" href="namespacempbits.html#aae2845e345a87b36b52288605541a96d">bitmap</a>(l),m)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordflow">RETURN</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="afc3196af7a116ae0050f96c940c03ba3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc3196af7a116ae0050f96c940c03ba3">&#9670;&nbsp;</a></span>ndbits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ndbits </td>
          <td>(</td>
          <td class="paramtype">integer(mpl), dimension(4), intent(out)&#160;</td>
          <td class="paramname"><em>ndims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>ncmprs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpl), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>nsparr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>ihst</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Analyze bit fields. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ndims</td><td>(1): (reduced) size of bit array; (2): size of column lists; (3/4): number of (double/single precision) off diagonal elements; </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ncmprs</td><td>compression info (per row) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nsparr</td><td>row offsets </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ihst</td><td>&gt;0: histogram number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpbits_8f90_source.html#l00224">224</a> of file <a class="el" href="mpbits_8f90_source.html">mpbits.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempbits.html">mpbits</a></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span>, <span class="keywordtype">DIMENSION(4)</span>, <span class="keywordtype">INTENT(OUT)</span> :: ndims</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(OUT)</span> :: ncmprs</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">INTENT(OUT)</span> :: nsparr</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: ihst</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: nwcp(0:1)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: irgn(2)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: inr(2)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ichunk</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: m</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: last</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: lrgn</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: next</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: icp</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: mm</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: jp</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: nj</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ib</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ir</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: icount</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: iproc</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: iword</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: mb</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: n1</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: ll</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: lb</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: nin</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: ntot</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: noffi</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keywordtype">    REAL</span>(mps) :: cpr</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="keywordtype">    REAL</span>(mps) :: fracu</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keywordtype">    REAL</span>(mps) :: fracz</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordtype">LOGICAL</span> :: btest</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">!$    INTEGER(mpi) :: OMP_GET_THREAD_NUM</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    ndims(1)=<a class="code" href="namespacempbits.html#adde3f0055bb8b56e1361d8a872674b1a">ndimb</a></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    ndims(2)=0</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    ndims(3)=0</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    ndims(4)=0</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    ntot=0</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    ll=0</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    lb=0</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    ichunk=min((<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>+<a class="code" href="namespacempbits.html#ac6629aea8d521ce7ee77d482c19ac192">nthrd</a>-1)/<a class="code" href="namespacempbits.html#ac6629aea8d521ce7ee77d482c19ac192">nthrd</a>/32+1,256)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">IF</span> (<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a> &gt; 1.OR.<a class="code" href="namespacempbits.html#ab5958876cd2674615d094fd9bfc0a9a6">icmprs</a> &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="comment">! reduce bit field counters to (precision type) bits, analyze precision type bit fields (&#39;1st half&#39; (j&lt;i))</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="comment">! parallelize row loop</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">! private copy of NTOT for each thread, combined at end, init with 0.</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="comment">!$OMP  PARALLEL DO &amp;</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="comment">!$OMP  PRIVATE(I,NOFFI,LL,MM,LB,MB,IWORD,IPROC,J,ICOUNT,IB,INR,IRGN,LAST,LRGN,NEXT,JP,IR) &amp;</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="comment">!$OMP  REDUCTION(+:NTOT) &amp;</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="comment">!$OMP  SCHEDULE(DYNAMIC,ICHUNK)</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">DO</span> i=1,<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            noffi=int(i-1,mpl)*int(i-2,mpl)*int(<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a>,mpl)/2</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            ll=noffi/<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>+i</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            mm=0</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            lb=ll</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            mb=0</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            iword=0 <span class="comment">! temporary bit fields</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            iproc=0</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="comment">!$ IPROC=OMP_GET_THREAD_NUM()         ! thread number</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            inr(1)=0</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            inr(2)=0</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            irgn(1)=0</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            irgn(2)=0</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            last=0</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            lrgn=0</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="keywordflow">DO</span> j=1,i-1</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                <span class="comment">! get (pair) counter</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                icount=0</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                next=0</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <span class="keywordflow">DO</span> ib=0,<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a>-1</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                    <span class="keywordflow">IF</span> (btest(<a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>(ll),mm)) icount=ibset(icount,ib)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                    mm=mm+1</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    <span class="keywordflow">IF</span> (mm &gt;= <a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                        ll=ll+1</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                        mm=mm-<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="keywordflow">                    END IF</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="keywordflow">                END DO</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                <span class="keywordflow">IF</span> (icount &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    ntot=ntot+1</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                    <span class="keywordflow">IF</span> (iproc == 0.AND.ihst &gt; 0) <span class="keyword">CALL </span>hmpent(ihst,real(icount,mps))</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                <span class="comment">! keep pair ?</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <span class="keywordflow">IF</span> (icount &gt;= <a class="code" href="namespacempbits.html#a092b420ebdc762fc51b649ca475a83f2">ireqpe</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    next=1 <span class="comment">! double</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    <span class="keywordflow">IF</span> (icount &lt;= <a class="code" href="namespacempbits.html#a7e33d38506425a8cdae517d26b465e97">isngpe</a>) next=2 <span class="comment">! single</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                    iword=ibset(iword,mb+next-1)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                    inr(next)=inr(next)+1</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                    <span class="keywordflow">IF</span> (next /= last.OR.lrgn &gt;= <a class="code" href="namespacempbits.html#af16fc58e032267904bb39d4c70fdb61c">nencdm</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                        irgn(next)=irgn(next)+1</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                        lrgn=0</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="keywordflow">                    END IF</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                    lrgn=lrgn+1</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                last=next</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                mb=mb+<a class="code" href="namespacempbits.html#a51404b84b43ea15b55a5da3a5e0d9181">nspc</a></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <span class="keywordflow">IF</span> (mb &gt;= <a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                    <a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>(lb)=iword <span class="comment">! store</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    iword=0</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                    lb=lb+1</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                    mb=mb-<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>(lb)=iword <span class="comment">! store</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="comment">! save row statistics</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            ir=i+1</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="keywordflow">DO</span> jp=1,<a class="code" href="namespacempbits.html#a51404b84b43ea15b55a5da3a5e0d9181">nspc</a></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                nsparr(1,ir)=irgn(jp)    <span class="comment">! number of regions per row and precision</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                nsparr(2,ir)=inr(jp)     <span class="comment">! number of columns per row and precision</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                ir=ir+<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>+1</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="comment">! analyze precision type bit fields for extended storage, check for row compression</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="comment">! parallelize row loop</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="comment">! private copy of NDIMS for each thread, combined at end, init with 0.</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="comment">!$OMP  PARALLEL DO &amp;</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="comment">!$OMP  PRIVATE(I,NOFFI,NOFFJ,LL,MM,INR,IRGN,LAST,LRGN,J,NEXT,ICP,NWCP,JP,IR,IB) &amp;</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="comment">!$OMP  REDUCTION(+:NDIMS) &amp;</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="comment">!$OMP  SCHEDULE(DYNAMIC,ICHUNK)</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">DO</span> i=1,<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <span class="comment">! restore row statistics</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            irgn(1)=int(nsparr(1,i+1),mpi)</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            irgn(2)=int(nsparr(1,i+<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>+2),mpi)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            inr(1)=int(nsparr(2,i+1),mpi)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            inr(2)=int(nsparr(2,i+<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>+2),mpi)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="comment">! analyze precision type bit fields for extended storage (&#39;2nd half&#39; (j&gt;i) too) ?</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacempbits.html#a13ad9e08781d0d7591b9f3278a596a30">iextnd</a> &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                noffj=(i-1)*<a class="code" href="namespacempbits.html#a51404b84b43ea15b55a5da3a5e0d9181">nspc</a></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                mm=mod(noffj,<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                last=0</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                lrgn=0</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                <span class="comment">! remaining columns</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <span class="keywordflow">DO</span> j=i+1, <a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                    <span class="comment">! index for pair (J,I)</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                    noffi=int(j-1,mpl)*int(j-2,mpl)*int(<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a>,mpl)/2 <span class="comment">! for I=1</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    ll=noffi/<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>+j+noffj/<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a> <span class="comment">! row offset + column offset</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                    <span class="comment">! get precision type</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                    next=0</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    <span class="keywordflow">DO</span> ib=0,<a class="code" href="namespacempbits.html#a51404b84b43ea15b55a5da3a5e0d9181">nspc</a>-1</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                        <span class="keywordflow">IF</span> (btest(<a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>(ll),mm+ib)) next=ibset(next,ib)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="keywordflow">                    END DO</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                    <span class="comment">! keep pair ?</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                    <span class="keywordflow">IF</span> (next &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                        inr(next)=inr(next)+1</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                        <span class="keywordflow">IF</span> (next /= last.OR.lrgn &gt;= <a class="code" href="namespacempbits.html#af16fc58e032267904bb39d4c70fdb61c">nencdm</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                            irgn(next)=irgn(next)+1</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                            lrgn=0</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="keywordflow">                        END IF</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                        lrgn=lrgn+1</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordflow">                    END IF</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                    last=next</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keywordflow">                END DO</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="comment">! row statistics, compression</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            ir=i+1</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="keywordflow">DO</span> jp=1,<a class="code" href="namespacempbits.html#a51404b84b43ea15b55a5da3a5e0d9181">nspc</a></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                icp=0</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                nwcp(0)=inr(jp)                        <span class="comment">! list of column indices (default)</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="keywordflow">IF</span> (inr(jp) &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                    nwcp(1)=irgn(jp)+(irgn(jp)+7)/8    <span class="comment">! list of regions of consecutive columns (and group offsets)</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                    <span class="comment">! compress row ?</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                    <span class="keywordflow">IF</span> ((nwcp(1) &lt; nwcp(0).AND.<a class="code" href="namespacempbits.html#ab5958876cd2674615d094fd9bfc0a9a6">icmprs</a> &gt; 0).OR.<a class="code" href="namespacempbits.html#a13ad9e08781d0d7591b9f3278a596a30">iextnd</a> &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                        icp=1</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                        ncmprs(i+<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>*(jp-1))=irgn(jp)    <span class="comment">! number of regions per row and precision</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="keywordflow">                    END IF</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                    <span class="comment">! total space</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                    ndims(2)   =ndims(2)   +nwcp(icp)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    ndims(jp+2)=ndims(jp+2)+nwcp(0)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <span class="comment">! per row and precision</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                nsparr(1,ir)=nwcp(icp)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                nsparr(2,ir)=nwcp(0)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                ir=ir+<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>+1</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="comment">!$OMP END PARALLEL DO</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="comment">! sum up, fill row offsets</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        lb=1</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        n1=0</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        ll=<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>+1</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordflow">DO</span> jp=1,<a class="code" href="namespacempbits.html#a51404b84b43ea15b55a5da3a5e0d9181">nspc</a></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="keywordflow">DO</span> i=1,<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                n1=n1+1</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                nsparr(1,n1)=lb</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                nsparr(2,n1)=ll</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                lb=lb+nsparr(1,n1+1)</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                ll=ll+nsparr(2,n1+1)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            n1=n1+1</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            nsparr(1,n1)=lb</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            nsparr(2,n1)=ll</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            ll=1</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        nin=0</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        nsparr(1,1)=1</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        nsparr(2,1)=<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>+1</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        n1=1</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordflow">DO</span> i=1,<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            noffi=int(i-1,mpl)*int(i-2,mpl)/2</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            ll=noffi/<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>+i</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            nj=(i-1)/<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keywordflow">DO</span> k=0,nj</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                <span class="keywordflow">DO</span> m=0,<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>-1</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                    <span class="keywordflow">IF</span>(btest(<a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>(ll+k),m)) nin=nin+1</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="keywordflow">                END DO</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            n1=n1+1</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            nsparr(1,n1)=nsparr(1,1)+nin</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            nsparr(2,n1)=nsparr(2,1)+nin</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        ndims(2)=nin</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        ndims(3)=nin</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        ntot=nin</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    nin=ndims(3)+ndims(4)</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    fracz=200.0*real(ntot,mps)/real(<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>,mps)/real(<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>-1,mps)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    fracu=200.0*real(nin,mps)/real(<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>,mps)/real(<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>-1,mps)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;NDBITS: number of diagonal elements&#39;</span>,<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;NDBITS: number of used off-diagonal elements&#39;</span>,nin</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keyword">WRITE</span>(*,1000) <span class="stringliteral">&#39;fraction of non-zero off-diagonal elements&#39;</span>, fracz</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keyword">WRITE</span>(*,1000) <span class="stringliteral">&#39;fraction of used off-diagonal elements&#39;</span>, fracu</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">IF</span> (<a class="code" href="namespacempbits.html#ab5958876cd2674615d094fd9bfc0a9a6">icmprs</a> /= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        cpr=100.0*real(mpi*ndims(2)+mpd*ndims(3)+mps*ndims(4),mps)/real((mpd+mpi)*nin,mps)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="keyword">WRITE</span>(*,1000) <span class="stringliteral">&#39;compression ratio for off-diagonal elements&#39;</span>, cpr</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;1000 <span class="keyword">FORMAT</span>(<span class="stringliteral">&#39; NDBITS: &#39;</span>,a,f6.2,<span class="stringliteral">&#39; %&#39;</span>)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">RETURN</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a76f1a5c5e332b0acd9a036edf977c4fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76f1a5c5e332b0acd9a036edf977c4fe">&#9670;&nbsp;</a></span>spbits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spbits </td>
          <td>(</td>
          <td class="paramtype">integer(mpl), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>nsparr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>nsparc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>ncmprs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create sparsity information. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nsparr</td><td>row offsets </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nsparc</td><td>column indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ncmprs</td><td>compression info (per row, in: number of all regions, out: number of regions in 1st half (for accessing 2nd half)) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpbits_8f90_source.html#l00581">581</a> of file <a class="el" href="mpbits_8f90_source.html">mpbits.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempbits.html">mpbits</a></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempdalc.html">mpdalc</a></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">INTENT(IN)</span> :: nsparr</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(OUT)</span> :: nsparc</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: ncmprs</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: kl</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: l</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: ll</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: l1</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: k8</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: n1</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordtype">INTEGER(mpl)</span> :: noffi</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: j1</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: jb</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: jn</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: m</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ichunk</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: next</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: last</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: lrgn</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: nrgn</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: nrgn8</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordtype">LOGICAL</span> :: btest</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    ichunk=min((<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>+<a class="code" href="namespacempbits.html#ac6629aea8d521ce7ee77d482c19ac192">nthrd</a>-1)/<a class="code" href="namespacempbits.html#ac6629aea8d521ce7ee77d482c19ac192">nthrd</a>/32+1,256)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordflow">DO</span> jb=0,<a class="code" href="namespacempbits.html#a51404b84b43ea15b55a5da3a5e0d9181">nspc</a>-1</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="comment">! parallelize row loop</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="comment">!$OMP  PARALLEL DO &amp;</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="comment">!$OMP  PRIVATE(I,N1,NOFFI,NOFFJ,L,M,KL,L1,NRGN,NRGN8,K8,LAST,LRGN,LL,J1,JN,J,NEXT) &amp;</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="comment">!$OMP  SCHEDULE(DYNAMIC,ICHUNK)</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keywordflow">DO</span> i=1,<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            n1=i+jb*(<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>+1)</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            noffi=int(i-1,mpl)*int(i-2,mpl)*int(<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a>,mpl)/2</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            l=noffi/<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>+i</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            m=jb</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            kl=nsparr(1,n1)-1  <span class="comment">! pointer to row in NSPARC</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            l1=nsparr(2,n1)    <span class="comment">! pointer to row in sparse matrix</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            nrgn=ncmprs(i+<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>*jb)<span class="comment">! compression  (number of consecutive regions)</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            nrgn8=(nrgn+7)/8   <span class="comment">! number of groups (1 offset per group)</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            k8=kl</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            kl=kl+nrgn8        <span class="comment">! reserve space of offsets</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            last=0</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            lrgn=0</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            ll=l1-1</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            j1=0</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            jn=0</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <span class="keywordflow">DO</span> j=1,i-1         <span class="comment">!  loop for off-diagonal elements</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                next=0</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>(l) /= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                    <span class="keywordflow">IF</span>(btest(<a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>(l),m)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                        ll=ll+1</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                        <span class="keywordflow">IF</span> (nrgn &lt;= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                            kl=kl+1</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                            nsparc(kl)=j <span class="comment">! column index</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                            next=1</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                            <span class="keywordflow">IF</span> (last == 0.OR.jn &gt;= <a class="code" href="namespacempbits.html#af16fc58e032267904bb39d4c70fdb61c">nencdm</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                                <span class="keywordflow">IF</span> (mod(lrgn,8) == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                                    k8=k8+1</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                                    nsparc(k8)=int(ll-l1,mpi)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="keywordflow">                                END IF</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                                lrgn=lrgn+1</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                                kl=kl+1</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                                j1=ishft(j,<a class="code" href="namespacempbits.html#a580ac1bdd4da9d8d58dc54c5c6b51de5">nencdb</a>)</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                jn=0</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="keywordflow">                            END IF</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                            jn=jn+1</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                            nsparc(kl)=ior(j1,jn)</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="keywordflow">                        END IF</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="keywordflow">                    END IF</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                last=next</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                m=m+<a class="code" href="namespacempbits.html#a51404b84b43ea15b55a5da3a5e0d9181">nspc</a></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                <span class="keywordflow">IF</span> (m &gt;= <a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                    m=m-<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                    l=l+1</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="comment">! extended storage (&#39;2nd half&#39; too) ?</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacempbits.html#a13ad9e08781d0d7591b9f3278a596a30">iextnd</a> &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                noffj=(i-1)*<a class="code" href="namespacempbits.html#a51404b84b43ea15b55a5da3a5e0d9181">nspc</a></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                m=mod(noffj,<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>)+jb</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                last=0</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                ncmprs(i+<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>*jb)=lrgn <span class="comment">! remember number of regions in 1st half (j&lt;i)</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                <span class="comment">! remaining columns</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                <span class="keywordflow">DO</span> j=i+1, <a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    <span class="comment">! index for pair (J,I)</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    noffi=int(j-1,mpl)*int(j-2,mpl)*int(<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a>,mpl)/2 <span class="comment">! for I=1</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                    l=noffi/<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a>+j+noffj/<a class="code" href="namespacempbits.html#a4b6174ff4f7f83f062c5e161555035db">bs</a> <span class="comment">! row offset + column offset</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                    next=0</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                    <span class="keywordflow">IF</span>(btest(<a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>(l),m)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                        ll=ll+1</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                        <span class="keywordflow">IF</span> (nrgn &lt;= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                            kl=kl+1</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                            nsparc(kl)=j <span class="comment">! column index</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                            next=1</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                            <span class="keywordflow">IF</span> (last == 0.OR.jn &gt;= <a class="code" href="namespacempbits.html#af16fc58e032267904bb39d4c70fdb61c">nencdm</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                                <span class="keywordflow">IF</span> (mod(lrgn,8) == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                                    k8=k8+1</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                                    nsparc(k8)=int(ll-l1,mpi)</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="keywordflow">                                END IF</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                                lrgn=lrgn+1</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                                kl=kl+1</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                                j1=ishft(j,<a class="code" href="namespacempbits.html#a580ac1bdd4da9d8d58dc54c5c6b51de5">nencdb</a>)</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                jn=0</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="keywordflow">                            END IF</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                            jn=jn+1</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                            nsparc(kl)=ior(j1,jn)</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="keywordflow">                        END IF</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="keywordflow">                    END IF</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                    last=next</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="keywordflow">                END DO</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="comment">!$OMP END PARALLEL DO</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    n1=(<a class="code" href="namespacempbits.html#a456806b8abad6591c95cb43cf45991f5">n</a>+1)*<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;SPBITS: sparse structure constructed &#39;</span>,nsparr(1,n1), <span class="stringliteral">&#39; words&#39;</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;SPBITS: dimension parameter of matrix&#39;</span>,nsparr(2,1)-1</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">IF</span> (<a class="code" href="namespacempbits.html#a0ea64a113eb525506043be7c92133c96">ibfw</a> &lt;= 1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;SPBITS: index of last used location&#39;</span>,nsparr(2,n1)-1</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;SPBITS: index of last used double&#39;</span>,nsparr(2,n1/2)-1</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;SPBITS: index of last used single&#39;</span>,nsparr(2,n1)-1</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="keyword">CALL </span><a class="code" href="interfacempdalc_1_1mpdealloc.html">mpdealloc</a>(<a class="code" href="namespacempbits.html#aea397564ea86fb7fe2b1c114b0871f4f">bitfieldcounters</a>)</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="ttc" id="ainterfacempdalc_1_1mpdealloc_html"><div class="ttname"><a href="interfacempdalc_1_1mpdealloc.html">mpdalc::mpdealloc</a></div><div class="ttdoc">deallocate array</div><div class="ttdef"><b>Definition:</b> <a href="mpdalc_8f90_source.html#l00041">mpdalc.f90:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_23416660aff6402864c13eb5e981e75a.html">millepede</a></li><li class="navelem"><a class="el" href="mpbits_8f90.html">mpbits.f90</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
