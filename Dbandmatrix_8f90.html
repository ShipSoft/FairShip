<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FairShip: millepede/Dbandmatrix.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FairShip
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('Dbandmatrix_8f90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">Dbandmatrix.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Symmetric (band) matrix routines.  
<a href="#details">More...</a></p>

<p><a href="Dbandmatrix_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ae7c3aa67c619cbc0cddce57d91638e21"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Dbandmatrix_8f90.html#ae7c3aa67c619cbc0cddce57d91638e21">dchdec</a> (w, n, aux)</td></tr>
<tr class="memdesc:ae7c3aa67c619cbc0cddce57d91638e21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decomposition of symmetric matrix.  <a href="Dbandmatrix_8f90.html#ae7c3aa67c619cbc0cddce57d91638e21">More...</a><br /></td></tr>
<tr class="separator:ae7c3aa67c619cbc0cddce57d91638e21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a472487244372d9ac694e27728c10abaf"><td class="memItemLeft" align="right" valign="top">real(mps) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Dbandmatrix_8f90.html#a472487244372d9ac694e27728c10abaf">condes</a> (w, n, aux)</td></tr>
<tr class="memdesc:a472487244372d9ac694e27728c10abaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Etimate condition.  <a href="Dbandmatrix_8f90.html#a472487244372d9ac694e27728c10abaf">More...</a><br /></td></tr>
<tr class="separator:a472487244372d9ac694e27728c10abaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7082e5556fcc5d9aa30386f057f1b668"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Dbandmatrix_8f90.html#a7082e5556fcc5d9aa30386f057f1b668">dbcdec</a> (w, mp1, n, aux)</td></tr>
<tr class="memdesc:a7082e5556fcc5d9aa30386f057f1b668"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decomposition of symmetric band matrix.  <a href="Dbandmatrix_8f90.html#a7082e5556fcc5d9aa30386f057f1b668">More...</a><br /></td></tr>
<tr class="separator:a7082e5556fcc5d9aa30386f057f1b668"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34f648612f6844a8efb5d270bab69075"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Dbandmatrix_8f90.html#a34f648612f6844a8efb5d270bab69075">dbcprv</a> (w, mp1, n, b)</td></tr>
<tr class="memdesc:a34f648612f6844a8efb5d270bab69075"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print corr band matrix and pars.  <a href="Dbandmatrix_8f90.html#a34f648612f6844a8efb5d270bab69075">More...</a><br /></td></tr>
<tr class="separator:a34f648612f6844a8efb5d270bab69075"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1c3e86aeb0ac3f61b0c509bb0a115b6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Dbandmatrix_8f90.html#ad1c3e86aeb0ac3f61b0c509bb0a115b6">dbcprb</a> (w, mp1, n)</td></tr>
<tr class="memdesc:ad1c3e86aeb0ac3f61b0c509bb0a115b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print band matrix.  <a href="Dbandmatrix_8f90.html#ad1c3e86aeb0ac3f61b0c509bb0a115b6">More...</a><br /></td></tr>
<tr class="separator:ad1c3e86aeb0ac3f61b0c509bb0a115b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb6106f818777939a8ab8a9b4cfd0ed6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Dbandmatrix_8f90.html#acb6106f818777939a8ab8a9b4cfd0ed6">db2dec</a> (w, n, aux)</td></tr>
<tr class="memdesc:acb6106f818777939a8ab8a9b4cfd0ed6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decomposition (M=1).  <a href="Dbandmatrix_8f90.html#acb6106f818777939a8ab8a9b4cfd0ed6">More...</a><br /></td></tr>
<tr class="separator:acb6106f818777939a8ab8a9b4cfd0ed6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0515c2852523ee11459e47862cf86db"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Dbandmatrix_8f90.html#ad0515c2852523ee11459e47862cf86db">db3dec</a> (w, n, aux)</td></tr>
<tr class="memdesc:ad0515c2852523ee11459e47862cf86db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decomposition (M=2).  <a href="Dbandmatrix_8f90.html#ad0515c2852523ee11459e47862cf86db">More...</a><br /></td></tr>
<tr class="separator:ad0515c2852523ee11459e47862cf86db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b1534fdb3c6f8e69c96678d58681a94"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Dbandmatrix_8f90.html#a8b1534fdb3c6f8e69c96678d58681a94">dcfdec</a> (w, n)</td></tr>
<tr class="memdesc:a8b1534fdb3c6f8e69c96678d58681a94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decomposition of symmetric matrix.  <a href="Dbandmatrix_8f90.html#a8b1534fdb3c6f8e69c96678d58681a94">More...</a><br /></td></tr>
<tr class="separator:a8b1534fdb3c6f8e69c96678d58681a94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38cdd3641b7ffd05c5a6618057ac2a5f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Dbandmatrix_8f90.html#a38cdd3641b7ffd05c5a6618057ac2a5f">dbfdec</a> (w, mp1, n)</td></tr>
<tr class="memdesc:a38cdd3641b7ffd05c5a6618057ac2a5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decomposition of symmetric band matrix.  <a href="Dbandmatrix_8f90.html#a38cdd3641b7ffd05c5a6618057ac2a5f">More...</a><br /></td></tr>
<tr class="separator:a38cdd3641b7ffd05c5a6618057ac2a5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Symmetric (band) matrix routines. </p>
<dl class="section author"><dt>Author</dt><dd>Volker Blobel, University Hamburg, 2005-2009 (initial Fortran77 version) </dd>
<dd>
Claus Kleinwort, DESY (maintenance and developement)</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2009 - 2015 Deutsches Elektronen-Synchroton, Member of the Helmholtz Association, (DESY), HAMBURG, GERMANY <br  />
<br  />
 This library is free software; you can redistribute it and/or modify it under the terms of the GNU Library General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version. <br  />
<br  />
 This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Library General Public License for more details. <br  />
<br  />
 You should have received a copy of the GNU Library General Public License along with this program (see the file COPYING.LIB for more details); if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</dd></dl>
<p>For the original broken lines implementation by V. Blobel (University Hamburg). </p><pre class="fragment">    *************************************************************
    *                                                           *
    *   Subroutines for symmetric and symmetric band matrices,  *
    *   based on the (square root free) Cholesky decomposition. *
    *                                                           *
    *************************************************************

    All floating point arguments are in DOUBLE PRECISION (and all
    entry names start with a D).

    The Cholesky decomposition transforms a symmetric matrix W
    e.g. the matrix from normal equation of least squares,
    according to
                          W = L D L^         (L^ means L transposed)
    where D is a diagonal matrix and L is a unit triangular matrix
    (diagonal elements all ones, all elements above diagonal zero).

    The above decomposition allows to solve a matrix equation
                        W x = b
    in two steps, using an auxiliary vector y:

                 solve  L y = b  for y, and

               solve D L^ x = y  for x.

    The inverse matrix of W can be calculated from the decomposition.

    In least-squares normal equations the inverse matrix is equal to
    the covariance matrix of the fitted parameters. All diagonal elements
    of the inverse matrix, the parameter variances, are positive, and
    the matrix is positive-definite (all eigenvalues &gt; 0).

    The Cholesky algorithm is stable for a positive-definite matrix.
    The standard form of the Cholesky algorithm includes n square roots
    for a n-by-n matrix, and is possible only for positive-definite
    matrices. The version used here is squareroot-free; this algorithm
    does not necessarily break down in the indefinite case, although
    it is potentially unstable in this case. All decomposition routines
    include a check for singularity, and this check needs an auxiliary
    array AUX of dimension n.

    Method: The Cholesky algorithm for symmetric matrix decomposition
    makes use of the symmetry. The operation count (leading term)
    is n**3/6 (compared to n**3/3 for normal Gaussian elimination).
    The solution of the two triangular systems involves operations
    proportional to n**2.

    The real advantage of the Cholesky algorithm is for band matrices,
    where all matrix elements outside of a band with total width
    (2m+1) around the diagonal are zero. The band structure is kept
    in the decomposition, and allows a fast solution of matrix equations.
    The operation count (leading term) is proportional to m**2*n
    and thus (for fixed m) linear in n. Thus for n=100 and m=2 the
    Cholesky algorithm for the band matrix is 1000 times faster than
    the standard solution method.

    The inverse of a band matrix is a full matrix. It is not necessary
    to calculate the inverse, if only the solution for a matrix equation
    is needed. However the inverse is often needed, because the elements
    of the inverse are the variances and covariances of parameters in
    a least-squares fit. The inverse can be calculated afterwards from
    the decomposition. Since the inverse matrix is a full matrix, this
    has of course an operation count proportional to n**3.

    Usually only the elements of the inverse in and around the diagonal
    are really needed, and this subset of inverse elements, corresponding
    to the original band, can be calculated from the decomposition with
    an operation count, which is linear in n. Thus all variances (the
    diagonal elements) and covariances between neighbour parameters
    are calculated in a short time even for large matrices.

    Matrix storage: the mathematical indexing of matrix elements follows
    the scheme:

                      (  W11   W12   W13 ... W1n  )
                      (  W21   W22   W23 ... W2n  )
                  W = (  ...   ...   ...     ...  )
                      (  ...   ...   ...     ...  )
                      (  Wn1   Wn2   Wn3 ... Wnn  )

    and a storage in an array would require n**2 words, although the
    symmetric matrix has only (n**2+n)/2 different elements, and a band
    matrix has less than (m+1)*n different elements. Therefore the
    following storage schemes are used.

    Symmetric matrix: the elements are in the order
            W11   W12   W22   W13   W23   W33   W14 ... Wnn
    with total (n**2+n)/2 array elements.

    Band matrix: a band matrix of bandwidth m is stored in an array
    of dimension W(m+1,n), according to

                      W(1,.)    W(2,.)    W(3,.)
                     --------------------------------
                       W11       W12       W13
                       W22       W23       W24
                       W33       W34       W35
                       ...
                       Wnn        -         -

    The example is for a bandwidth of m=2; three elements at the end
    are unused. The diagonal elements are in the array elements W(1,.).

    This package includes subroutines for:

       (1) Symmetric matrix W: decomposition, solution, inverse

       (2) Symmetric band matrix: decomposition, solution, complete
           inverse and band part of the inverse

       (3) Symmetric band matrix of band width m=1: decomposition,
           solution, complete, inverse and band part of the inverse

       (4) Symmetric band matrix of band width m=2: decomposition,
           solution, complete, inverse and band part of the inverse

       (5) Symmetric matrix with band structure, bordered by full row/col
           (not yet included)

    The subroutines for a fixed band width of m=1 and of m=2 are
    faster than the general routine, because certain loops are avoided
    and replaced by the direct code.

    Historical remark: the square-root algorithm was invented by the
    french Mathematician Andre-Louis Cholesky (1875 - 1918).
    Cholesky's method of computing solutions to the normal equations was
    published 1924, after the death of Cholesky, by Benoit.
    The method received little attention after its publication in 1924.
    In 1948 the method was analysed in a paper by Fox, Huskey and
    Wilkinson, and in the same year Turing published a paper on the
    stability of the method.

    The fast method to calculate the band part of the inverse matrix
    is usually not mentioned in the literature. An exception is:
    I.S.Duff, A.M.Erisman and J.K.Reid, Direct Methods for Sparse
    Matrices, Oxford Science Publications, 1986.
    The following original work is quoted in this book:
    K.Takahashi, J.Fagan and M.Chin, Formation of a sparse bus
    impedance matrix and its application to short circuit study.
    Proceedings 8th PICA Conference, Minneapolis, Minnesota, 1973
    A.M.Erisman and W.F.Tinney, On computing certain elements of the
    inverse of a sparse matrix, CACM 18, 177-179, 1975



    symmetric          decomposit. solution    inv-element    inverse
    ----------------  |-----------|-----------|--------------|-----------|
    n x n matrix        DCHDEC      DCHSLV      -              DCHINV
    band matrix m,n     DBCDEC      DBCSLV      DBCIEL/DBCINB  DBCINV
    bandwidth m=1       DB2DEC      DB2SLV      DB2IEL         -
    bandwidth m=2       DB3DEC      DB3SLV      DB3IEL         -

    The DB2... and DB3... routines are special routines for a fixed bandwidth
    of 1 and 2, they are faster versions of the general DBG... routines.
    The complete inverse matrix can be obtained by DBGINV.
    The routine DBGPRI can be used to print all types of band matrices.

    The decomposition in routines ...DEC replaces (overwrites) the
    original matrix (the number of elements is identical). All other
    routines require W to be the already decomposed matrix.
    The matrix L is a unit lower triangular matrix, with ones on the
    diagonal, which have not be stored. Instead the inverse of the
    diagonal elements of matrix D are stored in those places.

    In the  solution routines ...SLV the array B is the right-hand matrix,
    the array is the resulting solution. The same array can be used
    for B and X.


    W(.) and V(.) are symmetric n-by-n matrices with (N*N+N)/2 elements

    SUBROUTINE DCHDEC(W,N, AUX)      ! decomposition, symmetric matrix
         ENTRY DCHSLV(W,N,B, X)      ! solution B -&gt; X
         ENTRY DCHINV(W,N, V)        ! inversion

    SUBROUTINE DCFDEC(W,N)           ! modified composition, symmetric
                                     ! alternative to DCHDEC

    W(.) and V(.) are band matrices, n rows, band width m (i.e. the total
         width of the band is (2m+1).
         With MP1 = m +1, the array has dimension W(MP1,N).
         The symmetric matrix VS has (N*N+N)/2 elements

    SUBROUTINE DBCDEC(W,MP1,N, AUX)  ! decomposition, bandwidth M
         ENTRY DBCSLV(W,MP1,N,B, X)  ! solution B -&gt; X
         ENTRY DBCIEL(W,MP1,N, V)    ! V = inverse band matrix elements
         ENTRY DBCINV(W,MP1,N, VS)   ! V = inverse symmetric matrix

    SUBROUTINE DBFDEC(W,MP1,N)       ! modified decomposition, bandwidth M
                                     ! alternative to DBCDEC

    SUBROUTINE DBCPRB(W,MP1,N)       ! print band matrix
    SUBROUTINE DBCPRV(W,MP1,N,B)     ! print corr band matrix and pars

    SUBROUTINE DB2DEC(W,N, AUX)      ! decomposition (M=1)
         ENTRY DB2SLV(W,N,B, X)      ! solution B -&gt; X
         ENTRY DB2IEL(W,N, V)        ! V = inverse band matrix elements

    SUBROUTINE DB3DEC(W,N, AUX)      ! decomposition (M=2)
         ENTRY DB3SLV(W,N,B, X)      ! solution B -&gt; X
         ENTRY DB3IEL(W,N, V)        ! V = inverse band matrix elements
</pre> 
<p class="definition">Definition in file <a class="el" href="Dbandmatrix_8f90_source.html">Dbandmatrix.f90</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a472487244372d9ac694e27728c10abaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a472487244372d9ac694e27728c10abaf">&#9670;&nbsp;</a></span>condes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(mps) function condes </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>aux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Etimate condition. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">W</td><td>symmetric matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AUX</td><td>scratch array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>condition </dd></dl>

<p class="definition">Definition at line <a class="el" href="Dbandmatrix_8f90_source.html#l00345">345</a> of file <a class="el" href="Dbandmatrix_8f90_source.html">Dbandmatrix.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempdef.html">mpdef</a></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="keywordtype">    REAL</span>(mps) :: cond</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ir</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: is</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: kk</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="keywordtype">    REAL</span>(mps) :: xla1</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keywordtype">    REAL</span>(mps) :: xlan</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>             :: w(*)</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: aux(n)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="keywordtype">    REAL</span>(mpd) :: suma,sumu,sums</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    ir=1</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    is=1</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">IF</span>(w((i*i+i)/2) &lt; w((is*is+is)/2)) is=i <span class="comment">! largest Dii</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">IF</span>(w((i*i+i)/2) &gt; w((ir*ir+ir)/2)) ir=i <span class="comment">! smallest Dii</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    sumu=0.0     <span class="comment">! find smallest eigenvalue</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    sums=0.0</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">DO</span> i=n,1,-1  <span class="comment">! backward</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        suma=0.0</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">IF</span>(i == ir) suma=1.0_mpd</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        kk=(i*i+i)/2</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordflow">DO</span> k=i+1,n</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            suma=suma-w(kk+i)*aux(k)             <span class="comment">! (K,I)</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            kk=kk+k</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        aux(i)=suma</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        sumu=sumu+aux(i)*aux(i)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    xlan=real(w((ir*ir+ir)/2)*sqrt(sumu),<a class="code" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">IF</span>(xlan /= 0.0) xlan=1.0/xlan</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordflow">IF</span>(i == is) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            sums=1.0_mpd</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(i &gt; is) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            sums=sums+w(is+(i*i-i)/2)**2</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="keywordflow">    END DO</span>       <span class="comment">! is Ws</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    xla1=0.0</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">IF</span>(w((is*is+is)/2) /= 0.0) xla1=real(sqrt(sums)/w((is*is+is)/2),<a class="code" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    cond=0.0</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">IF</span>(xla1 &gt; 0.0.AND.xlan &gt; 0.0) cond=xla1/xlan</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">!     estimated condition</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <a class="code" href="Dbandmatrix_8f90.html#a472487244372d9ac694e27728c10abaf">condes</a>=cond</div>
<div class="ttc" id="aDbandmatrix_8f90_html_a472487244372d9ac694e27728c10abaf"><div class="ttname"><a href="Dbandmatrix_8f90.html#a472487244372d9ac694e27728c10abaf">condes</a></div><div class="ttdeci">real(mps) function condes(w, n, aux)</div><div class="ttdoc">Etimate condition.</div><div class="ttdef"><b>Definition:</b> <a href="Dbandmatrix_8f90_source.html#l00345">Dbandmatrix.f90:346</a></div></div>
<div class="ttc" id="anamespacempdef_html"><div class="ttname"><a href="namespacempdef.html">mpdef</a></div><div class="ttdoc">Definition of constants.</div><div class="ttdef"><b>Definition:</b> <a href="mpdef_8f90_source.html#l00024">mpdef.f90:24</a></div></div>
<div class="ttc" id="anamespacempdef_html_aeda146bde2da88d0f6940fc9be01e963"><div class="ttname"><a href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mpdef::mps</a></div><div class="ttdeci">integer, parameter mps</div><div class="ttdef"><b>Definition:</b> <a href="mpdef_8f90_source.html#l00037">mpdef.f90:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acb6106f818777939a8ab8a9b4cfd0ed6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb6106f818777939a8ab8a9b4cfd0ed6">&#9670;&nbsp;</a></span>db2dec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine db2dec </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(2,n), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(inout)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>aux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decomposition (M=1). </p>
<p>W is a symmetrix positive definite band matrix of bandwidth 1(+1). W(1,.) are the diagonal elements, W(2,.) is the next diagonals; W(2,N) is never referenced. AUX is an auxiliary array of length N. W is decomposed to L D Lt, where D = diagonal and L unit triangular. A row is set to zero, if the diagonal element is reduced in previous steps by a word length (i.e. global correlation coefficient large). The resulting L and D replace W: the diagonal elements W(1,...) will contain the inverse of the D-elements; the diagonal elements of L are all 1 and not stored. The other elements of L are stored in the corresponding elements of W.</p>
<p>ENTRY DB2SLV(W,N,B, X), solution B -&gt; X <br  />
 ENTRY DB2IEL(W,N, V), V = inverse band matrix elements</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">W</td><td>symmetric band matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AUX</td><td>scratch array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Dbandmatrix_8f90_source.html#l00622">622</a> of file <a class="el" href="Dbandmatrix_8f90_source.html">Dbandmatrix.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempdef.html">mpdef</a></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: w(2,n)</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN OUT)</span>                  :: n</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: aux(n)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="keywordtype">    REAL</span>(mpd) :: v(2,n),b(n),x(n), rxw</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        aux(i)=16.0_mpd*w(1,i) <span class="comment">! save diagonal elements</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordflow">DO</span> i=1,n-1</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="keywordflow">IF</span>(w(1,i)+aux(i) /= aux(i)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            w(1,i)=1.0_mpd/w(1,i)</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            rxw=w(2,i)*w(1,i)</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            w(1,i+1)=w(1,i+1)-w(2,i)*rxw</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            w(2,i)=rxw</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">ELSE</span> <span class="comment">! singular</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            w(1,i)=0.0_mpd</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            w(2,i)=0.0_mpd</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">IF</span>(w(1,n)+aux(n) &gt; aux(n)) <span class="keywordflow">THEN</span>           <span class="comment">! N</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        w(1,n)=1.0_mpd/w(1,n)</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">ELSE</span> <span class="comment">! singular</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        w(1,n)=0.0_mpd</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    entry db2slv(w,n,b, x)      <span class="comment">! solution B -&gt; X</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">!     The equation W(original)*X=B is solved for X; input is B in vector X.</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        x(i)=b(i)</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">DO</span> i=1,n-1           <span class="comment">! by forward substitution</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        x(i+1)=x(i+1)-w(2,i)*x(i)</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    x(n)=x(n)*w(1,n)     <span class="comment">! and backward substitution</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordflow">DO</span> i=n-1,1,-1</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        x(i)=x(i)*w(1,i)-w(2,i)*x(i+1)</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    entry db2iel(w,n, v)        <span class="comment">! V = inverse band matrix elements</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="comment">!     The band elements of the inverse of W(original) are calculated,</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="comment">!     and stored in V in the same order as in W.</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="comment">!     Remaining elements of the inverse are not calculated.</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    v(1,n  )= w(1,n)</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    v(2,n-1)=-v(1,n  )*w(2,n-1)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">DO</span> i=n-1,3,-1</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        v(1,i  )= w(1,i  )-v(2,i  )*w(2,i  )</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        v(2,i-1)=-v(1,i  )*w(2,i-1)</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    v(1,2)= w(1,2)-v(2,2)*w(2,2)</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    v(2,1)=-v(1,2)*w(2,1)</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    v(1,1)= w(1,1)-v(2,1)*w(2,1)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad0515c2852523ee11459e47862cf86db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0515c2852523ee11459e47862cf86db">&#9670;&nbsp;</a></span>db3dec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine db3dec </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(3,n), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(inout)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>aux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decomposition (M=2). </p>
<p>W is a symmetrix positive definite band matrix of bandwidth 2(+1). W(1,.) are the diagonal elements, W(2,.) and W(3,.) are the next diagonals; W(3,N-1), W(2,N) and W(3,N) are never referenced. AUX is an auxiliary array of length N. W is decomposed to L D Lt, where D = diagonal and L unit triangular. A row is set to zero, if the diagonal element is reduced in previous steps by a word length (i.e. global correlation coefficient large). The resulting L and D replace W: the diagonal elements W(1,...) will contain the inverse of the D-elements; the diagonal elements of L are all 1 and not stored. The other elements of L are stored in the corresponding elements of W.</p>
<p>ENTRY DB3SLV(W,N,B, X), solution B -&gt; X <br  />
 ENTRY DB3IEL(W,N, V), V = inverse band matrix elements</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">W</td><td>symmetric band matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AUX</td><td>scratch array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Dbandmatrix_8f90_source.html#l00710">710</a> of file <a class="el" href="Dbandmatrix_8f90_source.html">Dbandmatrix.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempdef.html">mpdef</a></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: w(3,n)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN OUT)</span>                  :: n</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: aux(n)</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">! decompos</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="keywordtype">    REAL</span>(mpd) :: v(3,n),b(n),x(n), rxw</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        aux(i)=16.0_mpd*w(1,i) <span class="comment">! save diagonal elements</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordflow">DO</span> i=1,n-2</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <span class="keywordflow">IF</span>(w(1,i)+aux(i) /= aux(i)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            w(1,i)=1.0_mpd/w(1,i)</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            rxw=w(2,i)*w(1,i)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            w(1,i+1)=w(1,i+1)-w(2,i)*rxw</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            w(2,i+1)=w(2,i+1)-w(3,i)*rxw</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            w(2,i)=rxw</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            rxw=w(3,i)*w(1,i)</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            w(1,i+2)=w(1,i+2)-w(3,i)*rxw</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            w(3,i)=rxw</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="keywordflow">ELSE</span> <span class="comment">! singular</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            w(1,i)=0.0_mpd</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            w(2,i)=0.0_mpd</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            w(3,i)=0.0_mpd</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">IF</span>(w(1,n-1)+aux(n-1) &gt; aux(n-1)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        w(1,n-1)=1.0_mpd/w(1,n-1)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        rxw=w(2,n-1)*w(1,n-1)</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        w(1,n)=w(1,n)-w(2,n-1)*rxw</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        w(2,n-1)=rxw</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">ELSE</span> <span class="comment">! singular</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        w(1,n-1)=0.0_mpd</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        w(2,n-1)=0.0_mpd</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">IF</span>(w(1,n)+aux(n) &gt; aux(n)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        w(1,n)=1.0_mpd/w(1,n)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordflow">ELSE</span> <span class="comment">! singular</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        w(1,n)=0.0_mpd</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    entry db3slv(w,n,b, x)      <span class="comment">! solution B -&gt; X</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        x(i)=b(i)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordflow">DO</span> i=1,n-2           <span class="comment">! by forward substitution</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        x(i+1)=x(i+1)-w(2,i)*x(i)</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        x(i+2)=x(i+2)-w(3,i)*x(i)</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    x(n)=x(n)-w(2,n-1)*x(n-1)</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    x(n)=x(n)*w(1,n)     <span class="comment">! and backward substitution</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    x(n-1)=x(n-1)*w(1,n-1)-w(2,n-1)*x(n)</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordflow">DO</span> i=n-2,1,-1</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        x(i)=x(i)*w(1,i)-w(2,i)*x(i+1)-w(3,i)*x(i+2)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    entry db3iel(w,n, v)        <span class="comment">! V = inverse band matrix elements</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="comment">!     The band elements of the inverse of W(original) are calculated,</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="comment">!     and stored in V in the same order as in W.</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="comment">!     Remaining elements of the inverse are not calculated.</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    v(1,n  )= w(1,n)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    v(2,n-1)=-v(1,n  )*w(2,n-1)</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    v(3,n-2)=-v(2,n-1)*w(2,n-2)-v(1,n  )*w(3,n-2)</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    v(1,n-1)= w(1,n-1) -v(2,n-1)*w(2,n-1)</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    v(2,n-2)=-v(1,n-1)*w(2,n-2)-v(2,n-1)*w(3,n-2)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    v(3,n-3)=-v(2,n-2)*w(2,n-3)-v(1,n-1)*w(3,n-3)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">DO</span> i=n-2,3,-1</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        v(1,i  )= w(1,i  ) -v(2,i  )*w(2,i  )-v(3,i)*w(3,i  )</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        v(2,i-1)=-v(1,i  )*w(2,i-1)-v(2,i)*w(3,i-1)</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        v(3,i-2)=-v(2,i-1)*w(2,i-2)-v(1,i)*w(3,i-2)</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    v(1,2)= w(1,2) -v(2,2)*w(2,2)-v(3,2)*w(3,2)</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    v(2,1)=-v(1,2)*w(2,1)-v(2,2)*w(3,1)</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    v(1,1)= w(1,1) -v(2,1)*w(2,1)-v(3,1)*w(3,1)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7082e5556fcc5d9aa30386f057f1b668"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7082e5556fcc5d9aa30386f057f1b668">&#9670;&nbsp;</a></span>dbcdec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dbcdec </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(mp1,n), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>mp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>aux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decomposition of symmetric band matrix. </p>
<p>ENTRY DBCSLV(W,MP1,N,B, X) for solution B -&gt; X <br  />
 ENTRY DBCIEL(W,MP1,N, V), V = inverse band matrix elements <br  />
 ENTRY DBCINB(W,MP1,N, VS), VS = band part of inverse symmetric matrix <br  />
 ENTRY DBCINV(W,MP1,N, VS), V = inverse symmetric matrix</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">W</td><td>symmetric band matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MP1</td><td>band width (M) + 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AUX</td><td>scratch array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Dbandmatrix_8f90_source.html#l00419">419</a> of file <a class="el" href="Dbandmatrix_8f90_source.html">Dbandmatrix.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempdef.html">mpdef</a></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">!     M=MP1-1                                    N*M(M-1) dot operations</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: w(mp1,n)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: mp1</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: aux(n)</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">! decompos</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="keywordtype">    REAL</span>(mpd) :: v(mp1,n),b(n),x(n), vs(*),rxw</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">!     ...</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        aux(i)=16.0_mpd*w(1,i) <span class="comment">! save diagonal elements</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keywordflow">IF</span>(w(1,i)+aux(i) /= aux(i)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            w(1,i)=1.0/w(1,i)</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            w(1,i)=0.0_mpd  <span class="comment">! singular</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="keywordflow">DO</span> j=1,min(mp1-1,n-i)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            rxw=w(j+1,i)*w(1,i)</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <span class="keywordflow">DO</span> k=1,min(mp1-1,n-i)+1-j</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                w(k,i+j)=w(k,i+j)-w(k+j,i)*rxw</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            w(j+1,i)=rxw</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    entry dbcslv(w,mp1,n,b, x)  <span class="comment">! solution B -&gt; X</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">!                                                N*(2M-1) dot operations</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        x(i)=b(i)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">DO</span> i=1,n <span class="comment">! forward substitution</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">DO</span> j=1,min(mp1-1,n-i)</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            x(j+i)=x(j+i)-w(j+1,i)*x(i)</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">DO</span> i=n,1,-1 <span class="comment">! backward substitution</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        rxw=x(i)*w(1,i)</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keywordflow">DO</span> j=1,min(mp1-1,n-i)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            rxw=rxw-w(j+1,i)*x(j+i)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        x(i)=rxw</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    entry dbciel(w,mp1,n, v)    <span class="comment">! V = inverse band matrix elements</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">!                                               N*M*(M-1) dot operations</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">DO</span> i=n,1,-1</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        rxw=w(1,i)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordflow">DO</span> j=i,max(1,i-mp1+1),-1</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="keywordflow">DO</span> k=j+1,min(n,j+mp1-1)</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                rxw=rxw-v(1+abs(i-k),min(i,k))*w(1+k-j,j)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            v(1+i-j,j)=rxw</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            rxw=0.0</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    entry dbcinb(w,mp1,n, vs)   <span class="comment">! VS = band part of inverse symmetric matrix</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">!                                             N*M*(M-1) dot operations</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">DO</span> i=n,1,-1</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        rxw=w(1,i)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="keywordflow">DO</span> j=i,max(1,i-mp1+1),-1</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <span class="keywordflow">DO</span> k=j+1,min(n,j+mp1-1)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                rxw=rxw-vs((max(i,k)*(max(i,k)-1))/2+min(i,k))*w(1+k-j,j)</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            vs((i*i-i)/2+j)=rxw</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            rxw=0.0</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">!       DO J=MAX(1,I-MP1+1)-1,1,-1</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">!        VS((I*I-I)/2+J)=0.0</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">!       END DO</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    entry dbcinv(w,mp1,n, vs)   <span class="comment">! V = inverse symmetric matrix</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">!                                             N*N/2*(M-1) dot operations</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">DO</span> i=n,1,-1</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        rxw=w(1,i)</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordflow">DO</span> j=i,1,-1</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="keywordflow">DO</span> k=j+1,min(n,j+mp1-1)</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                rxw=rxw-vs((max(i,k)*(max(i,k)-1))/2+min(i,k))*w(1+k-j,j)</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            vs((i*i-i)/2+j)=rxw</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            rxw=0.0</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">RETURN</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad1c3e86aeb0ac3f61b0c509bb0a115b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1c3e86aeb0ac3f61b0c509bb0a115b6">&#9670;&nbsp;</a></span>dbcprb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dbcprb </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(mp1,n), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>mp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print band matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">W</td><td>symmetric band matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MP1</td><td>band width (M) + 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>size </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Dbandmatrix_8f90_source.html#l00572">572</a> of file <a class="el" href="Dbandmatrix_8f90_source.html">Dbandmatrix.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempdef.html">mpdef</a></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: w(mp1,n)</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: mp1</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">!     ...</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordflow">IF</span>(mp1 &gt; 6) <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keyword">WRITE</span>(*,101)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keyword">WRITE</span>(*,102) i,(w(j,i),j=1,mp1)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;101 <span class="keyword">FORMAT</span>(5x,<span class="stringliteral">&#39;i   Diag  &#39;</span>)</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;102 <span class="keyword">FORMAT</span>(1x,i5,6g12.4)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a34f648612f6844a8efb5d270bab69075"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34f648612f6844a8efb5d270bab69075">&#9670;&nbsp;</a></span>dbcprv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dbcprv </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(mp1,n), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>mp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print corr band matrix and pars. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">W</td><td>symmetric band matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MP1</td><td>band width (M) + 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">B</td><td>vector </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Dbandmatrix_8f90_source.html#l00526">526</a> of file <a class="el" href="Dbandmatrix_8f90_source.html">Dbandmatrix.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempdef.html">mpdef</a></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: nj</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="keywordtype">    REAL</span>(mps) :: rho</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: w(mp1,n)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: mp1</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: b(n)</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="keywordtype">    REAL</span>(mpd) :: ERR</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: irho(5)</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">!     ...</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keyword">WRITE</span>(*,101)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        err=sqrt(w(1,i))</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        nj=0</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keywordflow">DO</span> j=2,mp1</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="keywordflow">IF</span>(i+1-j &gt; 0.AND.nj &lt; 5) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                nj=nj+1</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                rho=real(w(j,i+1-j)/(err*sqrt(w(1,i+1-j))),<a class="code" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                irho(nj)=nint(100.0*abs(rho),<a class="code" href="namespacempdef.html#a3fc26af88c2fce97882db26de5535606">mpi</a>)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                <span class="keywordflow">IF</span>(rho &lt; 0.0) irho(nj)=-irho(nj)</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keyword">WRITE</span>(*,102) i,b(i),err,(irho(j),j=1,nj)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keyword">WRITE</span>(*,103)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;101 <span class="keyword">FORMAT</span>(5x,<span class="stringliteral">&#39;i   Param&#39;</span>,7x,<span class="stringliteral">&#39;error&#39;</span>,7x,<span class="stringliteral">&#39;  c(i,i-1) c(i,i-2)&#39;</span>/)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;102 <span class="keyword">FORMAT</span>(1x,i5,2g12.4,1x,5i9)</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;103 <span class="keyword">FORMAT</span>(33x,<span class="stringliteral">&#39;(correlation coefficients in percent)&#39;</span>)</div>
<div class="ttc" id="anamespacempdef_html_a3fc26af88c2fce97882db26de5535606"><div class="ttname"><a href="namespacempdef.html#a3fc26af88c2fce97882db26de5535606">mpdef::mpi</a></div><div class="ttdeci">integer, parameter mpi</div><div class="ttdef"><b>Definition:</b> <a href="mpdef_8f90_source.html#l00034">mpdef.f90:34</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a38cdd3641b7ffd05c5a6618057ac2a5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38cdd3641b7ffd05c5a6618057ac2a5f">&#9670;&nbsp;</a></span>dbfdec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dbfdec </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(mp1,n), intent(out)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(inout)&#160;</td>
          <td class="paramname"><em>mp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decomposition of symmetric band matrix. </p>
<p>Band matrix modified Cholesky decomposition, Philip E.Gill, Walter Murray and Margarete H.Wright: Practical Optimization, Academic Press, 1981</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">W</td><td>symmetric band matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MP1</td><td>band width (M) + 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>size </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Dbandmatrix_8f90_source.html#l00904">904</a> of file <a class="el" href="Dbandmatrix_8f90_source.html">Dbandmatrix.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempdef.html">mpdef</a></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: w(mp1,n)</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN OUT)</span>                  :: mp1</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i,j,k</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="keywordtype">    REAL</span>(mpd) :: epsm,gamm,xchi,beta,delta,theta</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    epsm=epsilon(epsm) <span class="comment">! machine precision</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    gamm=0.0_mpd   <span class="comment">! max diagonal element</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    xchi=0.0_mpd   <span class="comment">! max off-diagonal element</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="keywordflow">DO</span> k=1,n</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        gamm=max(gamm,abs(w(1,k)))</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="keywordflow">DO</span> j=2,min(mp1,n-k+1)</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            xchi=max(xchi,abs(w(j,k)))</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    beta=sqrt(max(gamm,xchi/max(1.0_mpd,sqrt(real(n*n-1,<a class="code" href="namespacempdef.html#a1f913a4d0f3752088f75db7d925b0ac1">mpd</a>))),epsm))</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    delta=epsm*max(1.0_mpd,gamm+xchi)</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordflow">DO</span> k=1,n</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="keywordflow">DO</span> i=2,min(mp1,k)</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            w(i,k-i+1)=w(i,k-i+1)*w(1,k-i+1)</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="keywordflow">DO</span> j=2,min(mp1,n-k+1)</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            <span class="keywordflow">DO</span> i=max(2,j+k+1-mp1),k</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                w(j,k)=w(j,k)-w(k-i+2,i-1)*w(j-i+k+1,i-1)</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        theta=0.0_mpd</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="keywordflow">DO</span> j=2,min(mp1,n-k+1)</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            theta=max(theta,abs(w(j,k)))</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        w(1,k)=1.0_mpd/max(abs(w(1,k)),(theta/beta)**2,delta)</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <span class="keywordflow">DO</span> j=2,min(mp1,n-k+1)</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            w(1,k+j-1)=w(1,k+j-1)-w(1,k)*w(j,k)**2</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="keywordflow">    END DO</span> <span class="comment">! K</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="ttc" id="anamespacempdef_html_a1f913a4d0f3752088f75db7d925b0ac1"><div class="ttname"><a href="namespacempdef.html#a1f913a4d0f3752088f75db7d925b0ac1">mpdef::mpd</a></div><div class="ttdeci">integer, parameter mpd</div><div class="ttdef"><b>Definition:</b> <a href="mpdef_8f90_source.html#l00038">mpdef.f90:38</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8b1534fdb3c6f8e69c96678d58681a94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b1534fdb3c6f8e69c96678d58681a94">&#9670;&nbsp;</a></span>dcfdec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dcfdec </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(*), intent(out)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decomposition of symmetric matrix. </p>
<p>Modified Cholesky decomposition, Philip E.Gill, Walter Murray and Margarete H.Wright: Practical Optimization, Academic Press, 1981</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">W</td><td>symmetirc matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>size </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Dbandmatrix_8f90_source.html#l00852">852</a> of file <a class="el" href="Dbandmatrix_8f90_source.html">Dbandmatrix.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempdef.html">mpdef</a></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: w(*)</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i,j,k</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="keywordtype">    REAL</span>(mpd) :: epsm,gamm,xchi,beta,delta,theta</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    epsm=epsilon(epsm) <span class="comment">! machine precision</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    gamm=0.0_mpd   <span class="comment">! max diagonal element</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    xchi=0.0_mpd   <span class="comment">! max off-diagonal element</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">DO</span> k=1,n</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        gamm=max(gamm,abs(w((k*k+k)/2)))</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordflow">DO</span> j=k+1,n</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            xchi=max(xchi,abs(w((j*j-j)/2+k)))</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    beta=sqrt(max(gamm,xchi/max(1.0_mpd,sqrt(real(n*n-1,<a class="code" href="namespacempdef.html#a1f913a4d0f3752088f75db7d925b0ac1">mpd</a>))),epsm))</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    delta=epsm*max(1.0_mpd,gamm+xchi)</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordflow">DO</span> k=1,n</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keywordflow">DO</span> i=1,k-1</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            w((k*k-k)/2+i)=w((k*k-k)/2+i)*w((i*i+i)/2)</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordflow">DO</span> j=k+1,n</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            <span class="keywordflow">DO</span> i=1,k-1</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                w((j*j-j)/2+k)=w((j*j-j)/2+k)-w((k*k-k)/2+i)*w((j*j-j)/2+i)</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        theta=0.0_mpd</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="keywordflow">DO</span> j=k+1,n</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            theta=max(theta,abs(w((j*j-j)/2+k)))</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        w((k*k+k)/2)=1.0_mpd/max(abs(w((k*k+k)/2)),(theta/beta)**2,delta)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <span class="keywordflow">DO</span> j=k+1,n</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            w((j*j+j)/2)=w((j*j+j)/2)-w((j*j-j)/2+k)**2*w((k*k+k)/2)</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="keywordflow">    END DO</span> <span class="comment">! K</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae7c3aa67c619cbc0cddce57d91638e21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7c3aa67c619cbc0cddce57d91638e21">&#9670;&nbsp;</a></span>dchdec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dchdec </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(*), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>aux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decomposition of symmetric matrix. </p>
<p>ENTRY DCHSLV(W,N,B, X) for solution B -&gt; X <br  />
 ENTRY DCHINV(W,N,V) for inversion</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">W</td><td>symmetirc matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AUX</td><td>scratch array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Dbandmatrix_8f90_source.html#l00245">245</a> of file <a class="el" href="Dbandmatrix_8f90_source.html">Dbandmatrix.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempdef.html">mpdef</a></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ii</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: jj</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: kk</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: l</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: m</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: w(*)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: aux(n)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keywordtype">    REAL</span>(mpd) :: b(*),x(*),v(*),suma,ratio</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">!     ...</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        aux(i)=16.0_mpd*w((i*i+i)/2) <span class="comment">! save diagonal elements</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    ii=0</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        ii=ii+i</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">IF</span>(w(ii)+aux(i) /= aux(i)) <span class="keywordflow">THEN</span>     <span class="comment">! GT</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            w(ii)=1.0_mpd/w(ii)                <span class="comment">! (I,I) div !</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            w(ii)=0.0_mpd</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        jj=ii</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">DO</span> j=i+1,n</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            ratio=w(i+jj)*w(ii)              <span class="comment">! (I,J) (I,I)</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            kk=jj</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="keywordflow">DO</span> k=j,n</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                w(kk+j)=w(kk+j)-w(kk+i)*ratio   <span class="comment">! (K,J) (K,I)</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                kk=kk+k</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keywordflow">            END DO</span> <span class="comment">! K</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            w(i+jj)=ratio                    <span class="comment">! (I,J)</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            jj=jj+j</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keywordflow">        END DO</span> <span class="comment">! J</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="keywordflow">    END DO</span> <span class="comment">! I</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    entry dchslv(w,n,b, x)       <span class="comment">! solution B -&gt; X</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;before copy&#39;</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        x(i)=b(i)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;after copy&#39;</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    ii=0</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        suma=x(i)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">DO</span> k=1,i-1</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            suma=suma-w(k+ii)*x(k)             <span class="comment">! (K,I)</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        x(i)=suma</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        ii=ii+i</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;after forward&#39;</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">DO</span> i=n,1,-1</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        suma=x(i)*w(ii)                    <span class="comment">! (I,I)</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        kk=ii</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">DO</span> k=i+1,n</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            suma=suma-w(kk+i)*x(k)             <span class="comment">! (K,I)</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            kk=kk+k</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        x(i)=suma</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        ii=ii-i</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;after backward&#39;</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    entry dchinv(w,n,v)         <span class="comment">! inversion</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    ii=(n*n-n)/2</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">DO</span> i=n,1,-1</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        suma=w(ii+i)                       <span class="comment">! (I,I)</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">DO</span> j=i,1,-1</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keywordflow">DO</span> k=j+1,n</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                l=min(i,k)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                m=max(i,k)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                suma=suma-w(j+(k*k-k)/2)*v(l+(m*m-m)/2) <span class="comment">! (J,K) (I,K)</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            v(ii+j)=suma                      <span class="comment">! (I,J)</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            suma=0.0_mpd</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        ii=ii-i+1</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keywordflow">    END DO</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_23416660aff6402864c13eb5e981e75a.html">millepede</a></li><li class="navelem"><a class="el" href="Dbandmatrix_8f90.html">Dbandmatrix.f90</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
