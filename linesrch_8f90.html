<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FairShip: millepede/linesrch.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FairShip
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('linesrch_8f90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">linesrch.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Line search.  
<a href="#details">More...</a></p>

<p><a href="linesrch_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacelinesrch"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelinesrch.html">linesrch</a></td></tr>
<tr class="memdesc:namespacelinesrch"><td class="mdescLeft">&#160;</td><td class="mdescRight">Line search data. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a51d0bfcb54529dd7ec244c1013a740e1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linesrch_8f90.html#a51d0bfcb54529dd7ec244c1013a740e1">ptline</a> (n, x, f, g, s, step, info)</td></tr>
<tr class="memdesc:a51d0bfcb54529dd7ec244c1013a740e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform linesearch.  <a href="linesrch_8f90.html#a51d0bfcb54529dd7ec244c1013a740e1">More...</a><br /></td></tr>
<tr class="separator:a51d0bfcb54529dd7ec244c1013a740e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9246f737a7f0e8a260a6a7c5d9b53897"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linesrch_8f90.html#a9246f737a7f0e8a260a6a7c5d9b53897">ptldef</a> (gtole, stmax, minfe, maxfe)</td></tr>
<tr class="memdesc:a9246f737a7f0e8a260a6a7c5d9b53897"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize line search.  <a href="linesrch_8f90.html#a9246f737a7f0e8a260a6a7c5d9b53897">More...</a><br /></td></tr>
<tr class="separator:a9246f737a7f0e8a260a6a7c5d9b53897"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f5aa61e120727553eeb125290e5b830"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linesrch_8f90.html#a0f5aa61e120727553eeb125290e5b830">ptlopt</a> (nf, m, slopes, steps)</td></tr>
<tr class="memdesc:a0f5aa61e120727553eeb125290e5b830"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get details.  <a href="linesrch_8f90.html#a0f5aa61e120727553eeb125290e5b830">More...</a><br /></td></tr>
<tr class="separator:a0f5aa61e120727553eeb125290e5b830"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa73a97efe3dd8fed52cd565400932a2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linesrch_8f90.html#afa73a97efe3dd8fed52cd565400932a2">ptlprt</a> (lunp)</td></tr>
<tr class="memdesc:afa73a97efe3dd8fed52cd565400932a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print line search data.  <a href="linesrch_8f90.html#afa73a97efe3dd8fed52cd565400932a2">More...</a><br /></td></tr>
<tr class="separator:afa73a97efe3dd8fed52cd565400932a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac10ccae3380187377a27750f40c0b55c"><td class="memItemLeft" align="right" valign="top">integer(mpi), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelinesrch.html#ac10ccae3380187377a27750f40c0b55c">linesrch::msfd</a> =20</td></tr>
<tr class="separator:ac10ccae3380187377a27750f40c0b55c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36f50a552b15eddb06111eabd927c44f"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">linesrch::nsfd</a></td></tr>
<tr class="memdesc:a36f50a552b15eddb06111eabd927c44f"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of function calls  <a href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">More...</a><br /></td></tr>
<tr class="separator:a36f50a552b15eddb06111eabd927c44f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b526399c72a84daaea2e3267367ff31"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelinesrch.html#a7b526399c72a84daaea2e3267367ff31">linesrch::idgl</a></td></tr>
<tr class="memdesc:a7b526399c72a84daaea2e3267367ff31"><td class="mdescLeft">&#160;</td><td class="mdescRight">index of smallest negative slope  <a href="namespacelinesrch.html#a7b526399c72a84daaea2e3267367ff31">More...</a><br /></td></tr>
<tr class="separator:a7b526399c72a84daaea2e3267367ff31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79c5aad725d0aca82a1f6f6b3aa9eeec"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelinesrch.html#a79c5aad725d0aca82a1f6f6b3aa9eeec">linesrch::idgr</a></td></tr>
<tr class="memdesc:a79c5aad725d0aca82a1f6f6b3aa9eeec"><td class="mdescLeft">&#160;</td><td class="mdescRight">index of smallest positive slope  <a href="namespacelinesrch.html#a79c5aad725d0aca82a1f6f6b3aa9eeec">More...</a><br /></td></tr>
<tr class="separator:a79c5aad725d0aca82a1f6f6b3aa9eeec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b03506bed54544300c6abf7fd9f55d1"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelinesrch.html#a5b03506bed54544300c6abf7fd9f55d1">linesrch::idgm</a></td></tr>
<tr class="memdesc:a5b03506bed54544300c6abf7fd9f55d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">index of minimal slope  <a href="namespacelinesrch.html#a5b03506bed54544300c6abf7fd9f55d1">More...</a><br /></td></tr>
<tr class="separator:a5b03506bed54544300c6abf7fd9f55d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a77c2b9596676451239cb04cf63dd4a"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelinesrch.html#a1a77c2b9596676451239cb04cf63dd4a">linesrch::minf</a> =1</td></tr>
<tr class="memdesc:a1a77c2b9596676451239cb04cf63dd4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">min. number of function calls  <a href="namespacelinesrch.html#a1a77c2b9596676451239cb04cf63dd4a">More...</a><br /></td></tr>
<tr class="separator:a1a77c2b9596676451239cb04cf63dd4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49afc6bcd218239d2098fdae6a16ed8b"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelinesrch.html#a49afc6bcd218239d2098fdae6a16ed8b">linesrch::maxf</a> =5</td></tr>
<tr class="memdesc:a49afc6bcd218239d2098fdae6a16ed8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">max. number of function calls  <a href="namespacelinesrch.html#a49afc6bcd218239d2098fdae6a16ed8b">More...</a><br /></td></tr>
<tr class="separator:a49afc6bcd218239d2098fdae6a16ed8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f69d663c2231516aa40874bfb336304"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelinesrch.html#a6f69d663c2231516aa40874bfb336304">linesrch::lsinfo</a></td></tr>
<tr class="memdesc:a6f69d663c2231516aa40874bfb336304"><td class="mdescLeft">&#160;</td><td class="mdescRight">(status) information  <a href="namespacelinesrch.html#a6f69d663c2231516aa40874bfb336304">More...</a><br /></td></tr>
<tr class="separator:a6f69d663c2231516aa40874bfb336304"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eca8be39fd066ce1a33e6d3878d90db"><td class="memItemLeft" align="right" valign="top">real(mpd), dimension(4, msfd)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">linesrch::sfd</a></td></tr>
<tr class="memdesc:a5eca8be39fd066ce1a33e6d3878d90db"><td class="mdescLeft">&#160;</td><td class="mdescRight">abscissa; function value; slope; predicted zero  <a href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">More...</a><br /></td></tr>
<tr class="separator:a5eca8be39fd066ce1a33e6d3878d90db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acab027208ff9f75b0aee185d7a53df2f"><td class="memItemLeft" align="right" valign="top">real(mpd)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelinesrch.html#acab027208ff9f75b0aee185d7a53df2f">linesrch::stmx</a> =0.9</td></tr>
<tr class="memdesc:acab027208ff9f75b0aee185d7a53df2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">maximum slope ratio  <a href="namespacelinesrch.html#acab027208ff9f75b0aee185d7a53df2f">More...</a><br /></td></tr>
<tr class="separator:acab027208ff9f75b0aee185d7a53df2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d1658372473d339fd5effa842201f1e"><td class="memItemLeft" align="right" valign="top">real(mpd)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelinesrch.html#a0d1658372473d339fd5effa842201f1e">linesrch::gtol</a></td></tr>
<tr class="memdesc:a0d1658372473d339fd5effa842201f1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">slope ratio  <a href="namespacelinesrch.html#a0d1658372473d339fd5effa842201f1e">More...</a><br /></td></tr>
<tr class="separator:a0d1658372473d339fd5effa842201f1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Line search. </p>
<dl class="section author"><dt>Author</dt><dd>Volker Blobel, University Hamburg, 2005-2009 (initial Fortran77 version) </dd>
<dd>
Claus Kleinwort, DESY (maintenance and developement)</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2009 - 2015 Deutsches Elektronen-Synchroton, Member of the Helmholtz Association, (DESY), HAMBURG, GERMANY <br  />
<br  />
 This library is free software; you can redistribute it and/or modify it under the terms of the GNU Library General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version. <br  />
<br  />
 This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Library General Public License for more details. <br  />
<br  />
 You should have received a copy of the GNU Library General Public License along with this program (see the file COPYING.LIB for more details); if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</dd></dl>
<p>Line search routine with sufficient decrease of slope.</p>
<p>In many minimization problems the objective function is close to quadratic, except far from the solution. Close to the minimum the behaviour may be almost quadratic or, due to round-off errors, it may have a non-smooth behaviour, which often complicates any further progress and the recognition of convergence. Round-off errors affect the function value, which may be large and small parameter changes result in small relative changes of the function value. Close to the minimum the gradient becomes small and the behaviour is not so much affected by Round-off errors. </p><pre class="fragment">     CALL PTLDEF(0.0,0.0, 0,0) ! init line search
     N=...
     X(.)=...
     D(.)=...
     ALPHA=1.0D0
10   F(X)=...
     G(X)=...
     IF(.) S(X)=..
     CALL PTLINE(N,X,F,G,D,ALPHA,INFO)
     IF(INFO.LT.0) GOTO 10
</pre> 
<p class="definition">Definition in file <a class="el" href="linesrch_8f90_source.html">linesrch.f90</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a9246f737a7f0e8a260a6a7c5d9b53897"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9246f737a7f0e8a260a6a7c5d9b53897">&#9670;&nbsp;</a></span>ptldef()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ptldef </td>
          <td>(</td>
          <td class="paramtype">real(mps), intent(in)&#160;</td>
          <td class="paramname"><em>gtole</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mps), intent(in)&#160;</td>
          <td class="paramname"><em>stmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>minfe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>maxfe</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize line search. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gtole</td><td>slope ratio </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stmax</td><td>total step limit </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">minfe</td><td>minimum number of evaluations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxfe</td><td>maximum number of evaluations <pre class="fragment">                   --- range ----       default
slope ratio        1.0E-4 ... 0.9         0.9
min. F-calls       1 ... 2                 1
max. F-calls       2 ... 10                5
</pre> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="linesrch_8f90_source.html#l00232">232</a> of file <a class="el" href="linesrch_8f90_source.html">linesrch.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacelinesrch.html">linesrch</a></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: minfe</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: maxfe</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keywordtype">    REAL</span>(mps), <span class="keywordtype">INTENT(IN)</span>    :: gtole</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="keywordtype">    REAL</span>(mps), <span class="keywordtype">INTENT(IN)</span>    :: stmax</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="namespacelinesrch.html#a0d1658372473d339fd5effa842201f1e">gtol</a>=max(1.0e-4,min(gtole,0.9e0))  <span class="comment">! slope ratio</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">IF</span>(gtole == 0.0) <a class="code" href="namespacelinesrch.html#a0d1658372473d339fd5effa842201f1e">gtol</a>=0.9_mpd   <span class="comment">! default slope ratio</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="namespacelinesrch.html#acab027208ff9f75b0aee185d7a53df2f">stmx</a>=stmax                    <span class="comment">! maximum total step</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacelinesrch.html#acab027208ff9f75b0aee185d7a53df2f">stmx</a> == 0.0_mpd) <a class="code" href="namespacelinesrch.html#acab027208ff9f75b0aee185d7a53df2f">stmx</a>=10.0_mpd <span class="comment">! default limit</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="namespacelinesrch.html#a1a77c2b9596676451239cb04cf63dd4a">minf</a>=max(1,min(minfe,<a class="code" href="namespacelinesrch.html#ac10ccae3380187377a27750f40c0b55c">msfd</a>-2)) <span class="comment">! minimum number of evaluations</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="namespacelinesrch.html#a49afc6bcd218239d2098fdae6a16ed8b">maxf</a>=max(2,min(maxfe,<a class="code" href="namespacelinesrch.html#ac10ccae3380187377a27750f40c0b55c">msfd</a>-1)) <span class="comment">! maximum number of evaluations</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">IF</span>(maxfe == 0) <a class="code" href="namespacelinesrch.html#a49afc6bcd218239d2098fdae6a16ed8b">maxf</a>=5         <span class="comment">! default max number of values</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a>=0                        <span class="comment">! reset</span></div>
<div class="ttc" id="anamespacelinesrch_html"><div class="ttname"><a href="namespacelinesrch.html">linesrch</a></div><div class="ttdoc">Line search data.</div><div class="ttdef"><b>Definition:</b> <a href="linesrch_8f90_source.html#l00052">linesrch.f90:52</a></div></div>
<div class="ttc" id="anamespacelinesrch_html_a0d1658372473d339fd5effa842201f1e"><div class="ttname"><a href="namespacelinesrch.html#a0d1658372473d339fd5effa842201f1e">linesrch::gtol</a></div><div class="ttdeci">real(mpd) gtol</div><div class="ttdoc">slope ratio</div><div class="ttdef"><b>Definition:</b> <a href="linesrch_8f90_source.html#l00067">linesrch.f90:67</a></div></div>
<div class="ttc" id="anamespacelinesrch_html_a1a77c2b9596676451239cb04cf63dd4a"><div class="ttname"><a href="namespacelinesrch.html#a1a77c2b9596676451239cb04cf63dd4a">linesrch::minf</a></div><div class="ttdeci">integer(mpi) minf</div><div class="ttdoc">min. number of function calls</div><div class="ttdef"><b>Definition:</b> <a href="linesrch_8f90_source.html#l00062">linesrch.f90:62</a></div></div>
<div class="ttc" id="anamespacelinesrch_html_a36f50a552b15eddb06111eabd927c44f"><div class="ttname"><a href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">linesrch::nsfd</a></div><div class="ttdeci">integer(mpi) nsfd</div><div class="ttdoc">number of function calls</div><div class="ttdef"><b>Definition:</b> <a href="linesrch_8f90_source.html#l00058">linesrch.f90:58</a></div></div>
<div class="ttc" id="anamespacelinesrch_html_a49afc6bcd218239d2098fdae6a16ed8b"><div class="ttname"><a href="namespacelinesrch.html#a49afc6bcd218239d2098fdae6a16ed8b">linesrch::maxf</a></div><div class="ttdeci">integer(mpi) maxf</div><div class="ttdoc">max. number of function calls</div><div class="ttdef"><b>Definition:</b> <a href="linesrch_8f90_source.html#l00063">linesrch.f90:63</a></div></div>
<div class="ttc" id="anamespacelinesrch_html_ac10ccae3380187377a27750f40c0b55c"><div class="ttname"><a href="namespacelinesrch.html#ac10ccae3380187377a27750f40c0b55c">linesrch::msfd</a></div><div class="ttdeci">integer(mpi), parameter msfd</div><div class="ttdef"><b>Definition:</b> <a href="linesrch_8f90_source.html#l00057">linesrch.f90:57</a></div></div>
<div class="ttc" id="anamespacelinesrch_html_acab027208ff9f75b0aee185d7a53df2f"><div class="ttname"><a href="namespacelinesrch.html#acab027208ff9f75b0aee185d7a53df2f">linesrch::stmx</a></div><div class="ttdeci">real(mpd) stmx</div><div class="ttdoc">maximum slope ratio</div><div class="ttdef"><b>Definition:</b> <a href="linesrch_8f90_source.html#l00066">linesrch.f90:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a51d0bfcb54529dd7ec244c1013a740e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51d0bfcb54529dd7ec244c1013a740e1">&#9670;&nbsp;</a></span>ptline()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ptline </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), intent(inout)&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), intent(out)&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform linesearch. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>dimension of problem </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">X</td><td>current iterate </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">F</td><td>associated function value </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">G</td><td>associated gradient </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">S</td><td>search vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">STEP</td><td>step factor (initially = 1.0) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">INFO</td><td>information <pre class="fragment"> = -1  repeat function evaluation
 =  0  input error (e.g. gradient not negative)
 =  1  convergence reached
 =  2  convergence assumed, but round-off errors
 =  3  too many function calls
 =  4  step factor ALPHA to small (ALPHA &lt;= TOL)
</pre> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="linesrch_8f90_source.html#l00089">89</a> of file <a class="el" href="linesrch_8f90_source.html">linesrch.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacelinesrch.html">linesrch</a></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: x(n)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: f</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: g(n)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: s(n)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: step</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>                     :: info</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>::  i1</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i2</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i               <span class="comment">! internal</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: im              <span class="comment">! internal</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keywordtype">    REAL</span>(mpd) :: alpha  <span class="comment">! internal</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keywordtype">    REAL</span>(mpd) :: dginit <span class="comment">! internal</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keywordtype">    REAL</span>(mpd) :: dg     <span class="comment">! internal</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="keywordtype">    REAL</span>(mpd) :: fsaved <span class="comment">! internal</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keywordtype">    REAL</span>(mpd) :: tot    <span class="comment">! internal</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keywordtype">    REAL</span>(mpd) :: fp1    <span class="comment">! internal</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keywordtype">    REAL</span>(mpd) :: fp2    <span class="comment">! internal</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordtype">SAVE</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">!     initialization ---------------------------------------------------</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    info=0             <span class="comment">! reset INFO flag</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    dg=0.0_mpd</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">DO</span> i=1,n           <span class="comment">!</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        dg=dg-g(i)*s(i)   <span class="comment">! DG = scalar product: grad x search</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keyword">END </span>do<span class="comment">!</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a> == 0) <span class="keywordflow">THEN</span>    <span class="comment">! initial call</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        dginit=dg          <span class="comment">! DG = initial directional gradient</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">IF</span>(dginit &gt;= 0.0_mpd) <span class="keywordflow">GO TO</span> 100 <span class="comment">! error: step not decreasing</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        step=1.0_mpd         <span class="comment">! initial step factor is one</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        alpha=step         <span class="comment">! get initial step factor</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        tot=0.0_mpd          <span class="comment">! reset total step</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="namespacelinesrch.html#a7b526399c72a84daaea2e3267367ff31">idgl</a>=1             <span class="comment">! index of smallest negative slope</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <a class="code" href="namespacelinesrch.html#a79c5aad725d0aca82a1f6f6b3aa9eeec">idgr</a>=0             <span class="comment">! index of smallest positive slope</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        fsaved=f           <span class="comment">! initial Function value</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a>=1             <span class="comment">! starting point of iteration</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(1,1)=0.0       <span class="comment">! abscissa</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(2,1)=0.0       <span class="comment">! reference function value</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,1)=dginit    <span class="comment">! slope</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(4,1)=0.0       <span class="comment">! predicted zero</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        im=1               <span class="comment">! optimum</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">ELSE</span>                  <span class="comment">! subsequent call</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a>=<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a>+1</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(1,<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a>)=tot          <span class="comment">! abscissa</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(2,<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a>)=f-fsaved     <span class="comment">! function value difference to reference</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a>)=dg           <span class="comment">! slope</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(4,<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a>)=0.0          <span class="comment">! predicted zero (see below)</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">IF</span>(dg &lt; <a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,im)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            im=<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">!        define interval indices IDGL and IDGR</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">IF</span>(dg &lt;= 0.0_mpd) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="keywordflow">IF</span>(dg &gt;= <a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,<a class="code" href="namespacelinesrch.html#a7b526399c72a84daaea2e3267367ff31">idgl</a>)) <a class="code" href="namespacelinesrch.html#a7b526399c72a84daaea2e3267367ff31">idgl</a>=<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">IF</span>(dg &gt;= 0.0_mpd) <span class="keywordflow">THEN</span>     <span class="comment">! limit to the right</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacelinesrch.html#a79c5aad725d0aca82a1f6f6b3aa9eeec">idgr</a> == 0) <a class="code" href="namespacelinesrch.html#a79c5aad725d0aca82a1f6f6b3aa9eeec">idgr</a>=<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordflow">IF</span>(dg &lt;= <a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,<a class="code" href="namespacelinesrch.html#a79c5aad725d0aca82a1f6f6b3aa9eeec">idgr</a>)) <a class="code" href="namespacelinesrch.html#a79c5aad725d0aca82a1f6f6b3aa9eeec">idgr</a>=<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">IF</span>(<a class="code" href="namespacelinesrch.html#a79c5aad725d0aca82a1f6f6b3aa9eeec">idgr</a> == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            i1=<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a>-1</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            i2=<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            i1=<a class="code" href="namespacelinesrch.html#a7b526399c72a84daaea2e3267367ff31">idgl</a></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            i2=<a class="code" href="namespacelinesrch.html#a79c5aad725d0aca82a1f6f6b3aa9eeec">idgr</a></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        fp1=<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,i1)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        fp2=<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,i2)                       <span class="comment">! interpolation</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(4,<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a>)=(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(1,i1)*fp2-<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(1,i2)*fp1)/(fp2-fp1)</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="comment">!        convergence tests</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">IF</span>(<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a> &gt;= <a class="code" href="namespacelinesrch.html#a1a77c2b9596676451239cb04cf63dd4a">minf</a>.AND.abs(dg) &lt;= abs(dginit)*<a class="code" href="namespacelinesrch.html#a0d1658372473d339fd5effa842201f1e">gtol</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="comment">!           normal convergence return with INFO=1 ----------------------</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            alpha=tot+alpha          <span class="comment">! total ALPHA is returned</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            step =alpha</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <a class="code" href="namespacelinesrch.html#a5b03506bed54544300c6abf7fd9f55d1">idgm</a>=<a class="code" href="namespacelinesrch.html#a7b526399c72a84daaea2e3267367ff31">idgl</a></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacelinesrch.html#a79c5aad725d0aca82a1f6f6b3aa9eeec">idgr</a> /= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,<a class="code" href="namespacelinesrch.html#a79c5aad725d0aca82a1f6f6b3aa9eeec">idgr</a>)+<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,<a class="code" href="namespacelinesrch.html#a7b526399c72a84daaea2e3267367ff31">idgl</a>) &lt; 0.0_mpd) <a class="code" href="namespacelinesrch.html#a5b03506bed54544300c6abf7fd9f55d1">idgm</a>=<a class="code" href="namespacelinesrch.html#a79c5aad725d0aca82a1f6f6b3aa9eeec">idgr</a></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordflow">GO TO</span> 101</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">IF</span>(<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a> &gt;= <a class="code" href="namespacelinesrch.html#a49afc6bcd218239d2098fdae6a16ed8b">maxf</a>) <span class="keywordflow">GO TO</span> 102 <span class="comment">! max number of function calls</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        alpha=min(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(4,<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a>),<a class="code" href="namespacelinesrch.html#acab027208ff9f75b0aee185d7a53df2f">stmx</a>)-tot     <span class="comment">! new step from previous</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">IF</span>(abs(alpha) &lt; 1.0e-3_mpd.AND.<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(4,<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a>) &gt; <a class="code" href="namespacelinesrch.html#acab027208ff9f75b0aee185d7a53df2f">stmx</a>) <span class="keywordflow">GO TO</span> 103</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">IF</span>(abs(alpha) &lt; 1.0e-3_mpd) <span class="keywordflow">GO TO</span> 104</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">!     prepare next function call ---------------------------------------</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        x(i)=x(i)+alpha*s(i)    <span class="comment">! step by ALPHA -&gt; new X</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    tot=tot+alpha            <span class="comment">!</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    step=tot</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    info=-1                  <span class="comment">! recalculate function and gradient</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="namespacelinesrch.html#a6f69d663c2231516aa40874bfb336304">lsinfo</a>=info</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">!     error exits ------------------------------------------------------</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;104 info=info+1              <span class="comment">! 4: step small</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;103 info=info+1              <span class="comment">! 3: maximum reached</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;102 info=info+1              <span class="comment">! 2: too many function calls</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;101 info=info+1              <span class="comment">! 1: normal convergence</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="namespacelinesrch.html#a6f69d663c2231516aa40874bfb336304">lsinfo</a>=info</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    im=1</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">DO</span> i=1,<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">IF</span>(abs(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,i)) &lt; abs(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,im))) im=i</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    alpha=<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(1,im)-<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(1,<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a>)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">IF</span>(im == <a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a>) <span class="keywordflow">RETURN</span>    <span class="comment">! already at minimum</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        x(i)=x(i)+alpha*s(i)    <span class="comment">! step by ALPHA to slope minimum</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    f=<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(2,im)+fsaved       <span class="comment">! F at minimum</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    step=<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(1,im)           <span class="comment">! total step at convergence</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">IF</span>(im /= 1) <span class="keywordflow">RETURN</span>       <span class="comment">! improvement</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    info=5                   <span class="comment">! no improvement</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;100 step=0.0_mpd               <span class="comment">! 0: initial slope not negative</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="namespacelinesrch.html#a6f69d663c2231516aa40874bfb336304">lsinfo</a>=info</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="ttc" id="anamespacelinesrch_html_a5b03506bed54544300c6abf7fd9f55d1"><div class="ttname"><a href="namespacelinesrch.html#a5b03506bed54544300c6abf7fd9f55d1">linesrch::idgm</a></div><div class="ttdeci">integer(mpi) idgm</div><div class="ttdoc">index of minimal slope</div><div class="ttdef"><b>Definition:</b> <a href="linesrch_8f90_source.html#l00061">linesrch.f90:61</a></div></div>
<div class="ttc" id="anamespacelinesrch_html_a5eca8be39fd066ce1a33e6d3878d90db"><div class="ttname"><a href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">linesrch::sfd</a></div><div class="ttdeci">real(mpd), dimension(4, msfd) sfd</div><div class="ttdoc">abscissa; function value; slope; predicted zero</div><div class="ttdef"><b>Definition:</b> <a href="linesrch_8f90_source.html#l00065">linesrch.f90:65</a></div></div>
<div class="ttc" id="anamespacelinesrch_html_a6f69d663c2231516aa40874bfb336304"><div class="ttname"><a href="namespacelinesrch.html#a6f69d663c2231516aa40874bfb336304">linesrch::lsinfo</a></div><div class="ttdeci">integer(mpi) lsinfo</div><div class="ttdoc">(status) information</div><div class="ttdef"><b>Definition:</b> <a href="linesrch_8f90_source.html#l00064">linesrch.f90:64</a></div></div>
<div class="ttc" id="anamespacelinesrch_html_a79c5aad725d0aca82a1f6f6b3aa9eeec"><div class="ttname"><a href="namespacelinesrch.html#a79c5aad725d0aca82a1f6f6b3aa9eeec">linesrch::idgr</a></div><div class="ttdeci">integer(mpi) idgr</div><div class="ttdoc">index of smallest positive slope</div><div class="ttdef"><b>Definition:</b> <a href="linesrch_8f90_source.html#l00060">linesrch.f90:60</a></div></div>
<div class="ttc" id="anamespacelinesrch_html_a7b526399c72a84daaea2e3267367ff31"><div class="ttname"><a href="namespacelinesrch.html#a7b526399c72a84daaea2e3267367ff31">linesrch::idgl</a></div><div class="ttdeci">integer(mpi) idgl</div><div class="ttdoc">index of smallest negative slope</div><div class="ttdef"><b>Definition:</b> <a href="linesrch_8f90_source.html#l00059">linesrch.f90:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0f5aa61e120727553eeb125290e5b830"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f5aa61e120727553eeb125290e5b830">&#9670;&nbsp;</a></span>ptlopt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ptlopt </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>nf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mps), dimension(3), intent(out)&#160;</td>
          <td class="paramname"><em>slopes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mps), dimension(3), intent(out)&#160;</td>
          <td class="paramname"><em>steps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get details. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">NF</td><td>number of function values </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">M</td><td>index of function value with smallest slope </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SLOPES</td><td>initial, current, smallest slope </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">STEPS</td><td>initial position, current, smallest step </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="linesrch_8f90_source.html#l00258">258</a> of file <a class="el" href="linesrch_8f90_source.html">linesrch.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacelinesrch.html">linesrch</a></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>                     :: nf</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>                     :: m</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keywordtype">    REAL</span>(mps), <span class="keywordtype">DIMENSION(3)</span>, <span class="keywordtype">INTENT(OUT)</span>          :: slopes</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="keywordtype">    REAL</span>(mps), <span class="keywordtype">DIMENSION(3)</span>, <span class="keywordtype">INTENT(OUT)</span>          :: steps</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">!     ...</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    nf=<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a> == 0) <span class="keywordflow">THEN</span>  <span class="comment">! no values</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        m=0</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">DO</span> i=1,3</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            slopes(i)=0.0</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            steps(i) =0.0</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">ELSE</span>                <span class="comment">! values exist</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        m=1</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">DO</span> i=1,<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="keywordflow">IF</span>(abs(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,i)) &lt; abs(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,m))) m=i</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        slopes(1)=real(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,1))</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        slopes(2)=real(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a>))</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        slopes(3)=real(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,m))</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        steps(1) =real(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(1,1))</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        steps(2) =real(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(1,<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a>))</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        steps(3) =real(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(1,m))</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="keywordflow">    END IF</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="afa73a97efe3dd8fed52cd565400932a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa73a97efe3dd8fed52cd565400932a2">&#9670;&nbsp;</a></span>ptlprt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ptlprt </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>lunp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print line search data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lunp</td><td>unit number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="linesrch_8f90_source.html#l00294">294</a> of file <a class="el" href="linesrch_8f90_source.html">linesrch.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacelinesrch.html">linesrch</a></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: im</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: lun</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: lunp</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="keywordtype">    REAL</span>(mps) :: ratio</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordtype">CHARACTER (LEN=2)</span> :: tlr</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">!     ...</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    lun=lunp</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">IF</span>(lun == 0) lun=6</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a> &lt;= 0) <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keyword">WRITE</span>(lun,*) <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keyword">WRITE</span>(lun,*) <span class="stringliteral">&#39;PTLINE: line-search method based on slopes&#39;</span>,  &amp;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="stringliteral">&#39; with sufficient slope-decrease&#39;</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keyword">WRITE</span>(lun,*) <span class="stringliteral">&#39;PTLDEF: slope ratio limit=&#39;</span>,<a class="code" href="namespacelinesrch.html#a0d1658372473d339fd5effa842201f1e">gtol</a></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keyword">WRITE</span>(lun,*) <span class="stringliteral">&#39;PTLDEF: maximum step =&#39;</span>,<a class="code" href="namespacelinesrch.html#acab027208ff9f75b0aee185d7a53df2f">stmx</a></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keyword">WRITE</span>(lun,*) <span class="stringliteral">&#39;PTLDEF:&#39;</span>,<a class="code" href="namespacelinesrch.html#a1a77c2b9596676451239cb04cf63dd4a">minf</a>,<span class="stringliteral">&#39; &lt;= nr of calls &lt;=&#39;</span>,<a class="code" href="namespacelinesrch.html#a49afc6bcd218239d2098fdae6a16ed8b">maxf</a></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keyword">WRITE</span>(lun,101)</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    im=1</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">DO</span> i=1,<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">IF</span>(abs(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,i)) &lt; abs(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,im))) im=i</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">DO</span> i=1,<a class="code" href="namespacelinesrch.html#a36f50a552b15eddb06111eabd927c44f">nsfd</a></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        tlr=<span class="stringliteral">&#39;  &#39;</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">IF</span>(i == im)   tlr=<span class="stringliteral">&#39;**&#39;</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keywordflow">IF</span>(i == <a class="code" href="namespacelinesrch.html#a7b526399c72a84daaea2e3267367ff31">idgl</a>) tlr(1:1)=<span class="stringliteral">&#39;L&#39;</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keywordflow">IF</span>(i == <a class="code" href="namespacelinesrch.html#a79c5aad725d0aca82a1f6f6b3aa9eeec">idgr</a>) tlr(2:2)=<span class="stringliteral">&#39;R&#39;</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">IF</span>(i == 1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keyword">WRITE</span>(lun,102) i-1, <a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(1,i),tlr,(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(j,i),j=2,4)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            ratio=real(abs(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,i)/<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(3,1)))</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="keyword">WRITE</span>(lun,103) i-1, <a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(1,i),tlr,(<a class="code" href="namespacelinesrch.html#a5eca8be39fd066ce1a33e6d3878d90db">sfd</a>(j,i),j=2,4),ratio</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacelinesrch.html#a6f69d663c2231516aa40874bfb336304">lsinfo</a> == 0) <span class="keyword">WRITE</span>(lun,*)  &amp;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="stringliteral">&#39;PTLINE: INFO=0  input error (e.g. gradient not negative)&#39;</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacelinesrch.html#a6f69d663c2231516aa40874bfb336304">lsinfo</a> == 1) <span class="keyword">WRITE</span>(lun,*) <span class="stringliteral">&#39;PTLINE: INFO=1  convergence reached&#39;</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacelinesrch.html#a6f69d663c2231516aa40874bfb336304">lsinfo</a> == 2) <span class="keyword">WRITE</span>(lun,*) <span class="stringliteral">&#39;PTLINE: INFO=2  too many function calls&#39;</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacelinesrch.html#a6f69d663c2231516aa40874bfb336304">lsinfo</a> == 3) <span class="keyword">WRITE</span>(lun,*) <span class="stringliteral">&#39;PTLINE: INFO=3  maximum step reached&#39;</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacelinesrch.html#a6f69d663c2231516aa40874bfb336304">lsinfo</a> == 4) <span class="keyword">WRITE</span>(lun,*) <span class="stringliteral">&#39;PTLINE: INFO=4  step too small (&lt; 0.001)&#39;</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keyword">WRITE</span>(lun,*) <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;101 <span class="keyword">FORMAT</span>(<span class="stringliteral">&#39;  i      x              F(x)         F&#39;</span><span class="stringliteral">&#39;(X)&#39;</span>,  &amp;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="stringliteral">&#39;          minimum     F&#39;</span><span class="stringliteral">&#39;(X)&#39;</span>)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;102 <span class="keyword">FORMAT</span>(i3,f12.6,1x,a2,g15.6,g14.6,f12.6,<span class="stringliteral">&#39;     ratio&#39;</span>)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;103 <span class="keyword">FORMAT</span>(i3,f12.6,1x,a2,g15.6,g14.6,f12.6,f10.3)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_23416660aff6402864c13eb5e981e75a.html">millepede</a></li><li class="navelem"><a class="el" href="linesrch_8f90.html">linesrch.f90</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
